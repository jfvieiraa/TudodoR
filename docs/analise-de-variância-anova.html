<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title> 8 Analise de variância (ANOVA) | Uso do sistema R para análise de dados</title>
  <meta name="description" content="Notas de aulas de práticas estatística com o uso do sistema R." />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content=" 8 Analise de variância (ANOVA) | Uso do sistema R para análise de dados" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Notas de aulas de práticas estatística com o uso do sistema R." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content=" 8 Analise de variância (ANOVA) | Uso do sistema R para análise de dados" />
  
  <meta name="twitter:description" content="Notas de aulas de práticas estatística com o uso do sistema R." />
  

<meta name="author" content="" />


<meta name="date" content="2020-04-29" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="testes-estatísticos.html"/>
<link rel="next" href="multivariada.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Pré requisitos</a></li>
<li class="chapter" data-level="2" data-path="r-básico.html"><a href="r-básico.html"><i class="fa fa-check"></i><b>2</b> R Básico</a><ul>
<li class="chapter" data-level="2.1" data-path="r-básico.html"><a href="r-básico.html#expressões"><i class="fa fa-check"></i><b>2.1</b> Expressões</a></li>
<li class="chapter" data-level="2.2" data-path="r-básico.html"><a href="r-básico.html#valores-booleanos"><i class="fa fa-check"></i><b>2.2</b> Valores Booleanos</a></li>
<li class="chapter" data-level="2.3" data-path="r-básico.html"><a href="r-básico.html#variáveis"><i class="fa fa-check"></i><b>2.3</b> Variáveis</a></li>
<li class="chapter" data-level="2.4" data-path="r-básico.html"><a href="r-básico.html#funções"><i class="fa fa-check"></i><b>2.4</b> Funções</a></li>
<li class="chapter" data-level="2.5" data-path="r-básico.html"><a href="r-básico.html#ajuda"><i class="fa fa-check"></i><b>2.5</b> Ajuda</a></li>
<li class="chapter" data-level="2.6" data-path="r-básico.html"><a href="r-básico.html#referência"><i class="fa fa-check"></i><b>2.6</b> Referência</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="estruturas-de-dados.html"><a href="estruturas-de-dados.html"><i class="fa fa-check"></i><b>3</b> Estruturas de Dados</a><ul>
<li class="chapter" data-level="3.1" data-path="estruturas-de-dados.html"><a href="estruturas-de-dados.html#vetor"><i class="fa fa-check"></i><b>3.1</b> Vetor</a><ul>
<li class="chapter" data-level="3.1.1" data-path="estruturas-de-dados.html"><a href="estruturas-de-dados.html#vetores-de-sequência"><i class="fa fa-check"></i><b>3.1.1</b> Vetores de Sequência</a></li>
<li class="chapter" data-level="3.1.2" data-path="estruturas-de-dados.html"><a href="estruturas-de-dados.html#nomes-de-vetores"><i class="fa fa-check"></i><b>3.1.2</b> Nomes de vetores</a></li>
<li class="chapter" data-level="3.1.3" data-path="estruturas-de-dados.html"><a href="estruturas-de-dados.html#plotando-um-vetor"><i class="fa fa-check"></i><b>3.1.3</b> Plotando um vetor</a></li>
<li class="chapter" data-level="3.1.4" data-path="estruturas-de-dados.html"><a href="estruturas-de-dados.html#operações-matemáticas"><i class="fa fa-check"></i><b>3.1.4</b> Operações matemáticas</a></li>
<li class="chapter" data-level="3.1.5" data-path="estruturas-de-dados.html"><a href="estruturas-de-dados.html#parcelas-de-dispersão"><i class="fa fa-check"></i><b>3.1.5</b> Parcelas de dispersão</a></li>
<li class="chapter" data-level="3.1.6" data-path="estruturas-de-dados.html"><a href="estruturas-de-dados.html#valores-faltantes"><i class="fa fa-check"></i><b>3.1.6</b> Valores Faltantes</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="estruturas-de-dados.html"><a href="estruturas-de-dados.html#matrizes"><i class="fa fa-check"></i><b>3.2</b> Matrizes</a><ul>
<li class="chapter" data-level="3.2.1" data-path="estruturas-de-dados.html"><a href="estruturas-de-dados.html#outras-formas"><i class="fa fa-check"></i><b>3.2.1</b> Outras formas</a></li>
<li class="chapter" data-level="3.2.2" data-path="estruturas-de-dados.html"><a href="estruturas-de-dados.html#acesso-a-matriz"><i class="fa fa-check"></i><b>3.2.2</b> Acesso a Matriz</a></li>
<li class="chapter" data-level="3.2.3" data-path="estruturas-de-dados.html"><a href="estruturas-de-dados.html#visualizações-em-dados-matriciais"><i class="fa fa-check"></i><b>3.2.3</b> Visualizações em dados matriciais</a></li>
<li class="chapter" data-level="3.2.4" data-path="estruturas-de-dados.html"><a href="estruturas-de-dados.html#mais-informações-sobre-construções-de-matrizes"><i class="fa fa-check"></i><b>3.2.4</b> Mais informações sobre construções de Matrizes</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="estruturas-de-dados.html"><a href="estruturas-de-dados.html#fatores"><i class="fa fa-check"></i><b>3.3</b> Fatores</a></li>
<li class="chapter" data-level="3.4" data-path="estruturas-de-dados.html"><a href="estruturas-de-dados.html#array"><i class="fa fa-check"></i><b>3.4</b> Array</a></li>
<li class="chapter" data-level="3.5" data-path="estruturas-de-dados.html"><a href="estruturas-de-dados.html#data.frame"><i class="fa fa-check"></i><b>3.5</b> Data.frame</a><ul>
<li class="chapter" data-level="3.5.1" data-path="estruturas-de-dados.html"><a href="estruturas-de-dados.html#índice-dos-data.frames"><i class="fa fa-check"></i><b>3.5.1</b> Índice dos Data.frames</a></li>
<li class="chapter" data-level="3.5.2" data-path="estruturas-de-dados.html"><a href="estruturas-de-dados.html#manipulando-um-data.frame"><i class="fa fa-check"></i><b>3.5.2</b> Manipulando um Data.frame</a></li>
<li class="chapter" data-level="3.5.3" data-path="estruturas-de-dados.html"><a href="estruturas-de-dados.html#separando-um-data.frame-por-grupos"><i class="fa fa-check"></i><b>3.5.3</b> Separando um data.frame por grupos</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="estruturas-de-dados.html"><a href="estruturas-de-dados.html#lista"><i class="fa fa-check"></i><b>3.6</b> Lista</a><ul>
<li class="chapter" data-level="3.6.1" data-path="estruturas-de-dados.html"><a href="estruturas-de-dados.html#alguns-comandos-que-retornam-listas"><i class="fa fa-check"></i><b>3.6.1</b> Alguns comandos que retornam listas</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="estruturas-de-dados.html"><a href="estruturas-de-dados.html#referência-1"><i class="fa fa-check"></i><b>3.7</b> Referência</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="entrada-de-dados.html"><a href="entrada-de-dados.html"><i class="fa fa-check"></i><b>4</b> Entrada de dados</a><ul>
<li class="chapter" data-level="4.1" data-path="entrada-de-dados.html"><a href="entrada-de-dados.html#onde-os-dados-devem-estar"><i class="fa fa-check"></i><b>4.1</b> Onde os dados devem estar?</a></li>
<li class="chapter" data-level="4.2" data-path="entrada-de-dados.html"><a href="entrada-de-dados.html#entrando-com-dados"><i class="fa fa-check"></i><b>4.2</b> Entrando com dados</a><ul>
<li class="chapter" data-level="4.2.1" data-path="entrada-de-dados.html"><a href="entrada-de-dados.html#vetores"><i class="fa fa-check"></i><b>4.2.1</b> Vetores</a></li>
<li class="chapter" data-level="4.2.2" data-path="entrada-de-dados.html"><a href="entrada-de-dados.html#usando-a-função-scan"><i class="fa fa-check"></i><b>4.2.2</b> Usando a função ‘scan’</a></li>
<li class="chapter" data-level="4.2.3" data-path="entrada-de-dados.html"><a href="entrada-de-dados.html#copiar-e-colar-usando-scan"><i class="fa fa-check"></i><b>4.2.3</b> Copiar e colar usando scan()</a></li>
<li class="chapter" data-level="4.2.4" data-path="entrada-de-dados.html"><a href="entrada-de-dados.html#lendo-dados-através-da-área-de-transferência"><i class="fa fa-check"></i><b>4.2.4</b> Lendo dados através da área de transferência</a></li>
<li class="chapter" data-level="4.2.5" data-path="entrada-de-dados.html"><a href="entrada-de-dados.html#usando-a-função-edit"><i class="fa fa-check"></i><b>4.2.5</b> Usando a função edit</a></li>
<li class="chapter" data-level="4.2.6" data-path="entrada-de-dados.html"><a href="entrada-de-dados.html#lendo-dados-de-um-arquivo-texto"><i class="fa fa-check"></i><b>4.2.6</b> Lendo dados de um arquivo texto</a></li>
<li class="chapter" data-level="4.2.7" data-path="entrada-de-dados.html"><a href="entrada-de-dados.html#dados-do-tipo-csv"><i class="fa fa-check"></i><b>4.2.7</b> Dados do tipo CSV</a></li>
<li class="chapter" data-level="4.2.8" data-path="entrada-de-dados.html"><a href="entrada-de-dados.html#a-seguir-listamos-algumas-destas-funções"><i class="fa fa-check"></i><b>4.2.8</b> A seguir listamos algumas destas funções:</a></li>
<li class="chapter" data-level="4.2.9" data-path="entrada-de-dados.html"><a href="entrada-de-dados.html#lendo-dados-disponíveis-na-web"><i class="fa fa-check"></i><b>4.2.9</b> Lendo dados disponíveis na web</a></li>
<li class="chapter" data-level="4.2.10" data-path="entrada-de-dados.html"><a href="entrada-de-dados.html#lendo-dados-de-uma-planilha-eletrônica"><i class="fa fa-check"></i><b>4.2.10</b> Lendo dados de uma planilha eletrônica</a></li>
<li class="chapter" data-level="4.2.11" data-path="entrada-de-dados.html"><a href="entrada-de-dados.html#exercícios"><i class="fa fa-check"></i><b>4.2.11</b> Exercícios</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="entrada-de-dados.html"><a href="entrada-de-dados.html#salvar-objetos-de-dados"><i class="fa fa-check"></i><b>4.3</b> Salvar objetos de dados</a><ul>
<li class="chapter" data-level="4.3.1" data-path="entrada-de-dados.html"><a href="entrada-de-dados.html#outras-funções"><i class="fa fa-check"></i><b>4.3.1</b> Outras funções</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="entrada-de-dados.html"><a href="entrada-de-dados.html#referência-2"><i class="fa fa-check"></i><b>4.4</b> Referência</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="criando-gráficos-com-o-r.html"><a href="criando-gráficos-com-o-r.html"><i class="fa fa-check"></i><b>5</b> Criando Gráficos com o R</a><ul>
<li class="chapter" data-level="5.1" data-path="criando-gráficos-com-o-r.html"><a href="criando-gráficos-com-o-r.html#exemplos-de-gráficos-com-o-r"><i class="fa fa-check"></i><b>5.1</b> Exemplos de gráficos com o R</a></li>
<li class="chapter" data-level="5.2" data-path="criando-gráficos-com-o-r.html"><a href="criando-gráficos-com-o-r.html#entrada-de-dados-1"><i class="fa fa-check"></i><b>5.2</b> Entrada de dados</a></li>
<li class="chapter" data-level="5.3" data-path="criando-gráficos-com-o-r.html"><a href="criando-gráficos-com-o-r.html#usando-a-função-plot"><i class="fa fa-check"></i><b>5.3</b> Usando a função <code>plot()</code></a><ul>
<li class="chapter" data-level="5.3.1" data-path="criando-gráficos-com-o-r.html"><a href="criando-gráficos-com-o-r.html#mudando-o-padrão-dos-pontos-pch"><i class="fa fa-check"></i><b>5.3.1</b> Mudando o padrão dos pontos <code>pch=</code></a></li>
<li class="chapter" data-level="5.3.2" data-path="criando-gráficos-com-o-r.html"><a href="criando-gráficos-com-o-r.html#mudando-as-linhas-lwd-e-lty"><i class="fa fa-check"></i><b>5.3.2</b> Mudando as linhas (<code>lwd e lty</code>)</a></li>
<li class="chapter" data-level="5.3.3" data-path="criando-gráficos-com-o-r.html"><a href="criando-gráficos-com-o-r.html#adicionando-linhas-a-um-grafico-de-pontos"><i class="fa fa-check"></i><b>5.3.3</b> Adicionando linhas a um grafico de pontos</a></li>
<li class="chapter" data-level="5.3.4" data-path="criando-gráficos-com-o-r.html"><a href="criando-gráficos-com-o-r.html#definindo-o-intervalo-dos-eixos"><i class="fa fa-check"></i><b>5.3.4</b> Definindo o intervalo dos eixos</a></li>
<li class="chapter" data-level="5.3.5" data-path="criando-gráficos-com-o-r.html"><a href="criando-gráficos-com-o-r.html#personalizando-os-gráficos"><i class="fa fa-check"></i><b>5.3.5</b> Personalizando os gráficos</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="criando-gráficos-com-o-r.html"><a href="criando-gráficos-com-o-r.html#histogramas"><i class="fa fa-check"></i><b>5.4</b> Histogramas</a><ul>
<li class="chapter" data-level="5.4.1" data-path="criando-gráficos-com-o-r.html"><a href="criando-gráficos-com-o-r.html#personalizando-gráficos"><i class="fa fa-check"></i><b>5.4.1</b> Personalizando gráficos</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="criando-gráficos-com-o-r.html"><a href="criando-gráficos-com-o-r.html#gráficos-de-barras"><i class="fa fa-check"></i><b>5.5</b> Gráficos de Barras</a></li>
<li class="chapter" data-level="5.6" data-path="criando-gráficos-com-o-r.html"><a href="criando-gráficos-com-o-r.html#boxplots"><i class="fa fa-check"></i><b>5.6</b> Boxplots</a><ul>
<li class="chapter" data-level="5.6.1" data-path="criando-gráficos-com-o-r.html"><a href="criando-gráficos-com-o-r.html#boxplot-com-fatorial"><i class="fa fa-check"></i><b>5.6.1</b> Boxplot com fatorial</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="criando-gráficos-com-o-r.html"><a href="criando-gráficos-com-o-r.html#cores"><i class="fa fa-check"></i><b>5.7</b> Cores</a></li>
<li class="chapter" data-level="5.8" data-path="criando-gráficos-com-o-r.html"><a href="criando-gráficos-com-o-r.html#interagindo-com-a-janela-gráfica"><i class="fa fa-check"></i><b>5.8</b> Interagindo com a Janela gráfica</a></li>
<li class="chapter" data-level="5.9" data-path="criando-gráficos-com-o-r.html"><a href="criando-gráficos-com-o-r.html#texto-e-tamanho-do-símbolo"><i class="fa fa-check"></i><b>5.9</b> Texto e tamanho do símbolo</a></li>
<li class="chapter" data-level="5.10" data-path="criando-gráficos-com-o-r.html"><a href="criando-gráficos-com-o-r.html#visualizar-vários-gráficos"><i class="fa fa-check"></i><b>5.10</b> Visualizar vários gráficos</a><ul>
<li class="chapter" data-level="5.10.1" data-path="criando-gráficos-com-o-r.html"><a href="criando-gráficos-com-o-r.html#varios-gráficos-na-mesma-janela-gráfica"><i class="fa fa-check"></i><b>5.10.1</b> Varios gráficos na mesma janela gráfica</a></li>
</ul></li>
<li class="chapter" data-level="5.11" data-path="criando-gráficos-com-o-r.html"><a href="criando-gráficos-com-o-r.html#salvando-gráficos"><i class="fa fa-check"></i><b>5.11</b> Salvando gráficos</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="gráficos-com-ggplot2.html"><a href="gráficos-com-ggplot2.html"><i class="fa fa-check"></i><b>6</b> Gráficos com ggplot2</a><ul>
<li class="chapter" data-level="6.1" data-path="gráficos-com-ggplot2.html"><a href="gráficos-com-ggplot2.html#personalizando-os-gráficos-1"><i class="fa fa-check"></i><b>6.1</b> Personalizando os gráficos</a><ul>
<li class="chapter" data-level="6.1.1" data-path="gráficos-com-ggplot2.html"><a href="gráficos-com-ggplot2.html#cores-1"><i class="fa fa-check"></i><b>6.1.1</b> Cores</a></li>
<li class="chapter" data-level="6.1.2" data-path="gráficos-com-ggplot2.html"><a href="gráficos-com-ggplot2.html#eixos"><i class="fa fa-check"></i><b>6.1.2</b> Eixos</a></li>
<li class="chapter" data-level="6.1.3" data-path="gráficos-com-ggplot2.html"><a href="gráficos-com-ggplot2.html#legenda"><i class="fa fa-check"></i><b>6.1.3</b> Legenda</a></li>
<li class="chapter" data-level="6.1.4" data-path="gráficos-com-ggplot2.html"><a href="gráficos-com-ggplot2.html#título"><i class="fa fa-check"></i><b>6.1.4</b> Título</a></li>
<li class="chapter" data-level="6.1.5" data-path="gráficos-com-ggplot2.html"><a href="gráficos-com-ggplot2.html#facets"><i class="fa fa-check"></i><b>6.1.5</b> Facets</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="gráficos-com-ggplot2.html"><a href="gráficos-com-ggplot2.html#exemplos"><i class="fa fa-check"></i><b>6.2</b> Exemplos</a><ul>
<li class="chapter" data-level="6.2.1" data-path="gráficos-com-ggplot2.html"><a href="gráficos-com-ggplot2.html#regressão"><i class="fa fa-check"></i><b>6.2.1</b> Regressão</a></li>
<li class="chapter" data-level="6.2.2" data-path="gráficos-com-ggplot2.html"><a href="gráficos-com-ggplot2.html#delineamento-em-blocos-casualizados--dbc"><i class="fa fa-check"></i><b>6.2.2</b> Delineamento em blocos casualizados- DBC</a></li>
<li class="chapter" data-level="6.2.3" data-path="gráficos-com-ggplot2.html"><a href="gráficos-com-ggplot2.html#dados-climáticos"><i class="fa fa-check"></i><b>6.2.3</b> Dados Climáticos</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="gráficos-com-ggplot2.html"><a href="gráficos-com-ggplot2.html#referência-3"><i class="fa fa-check"></i><b>6.3</b> Referência</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="testes-estatísticos.html"><a href="testes-estatísticos.html"><i class="fa fa-check"></i><b>7</b> Testes Estatísticos</a><ul>
<li class="chapter" data-level="7.1" data-path="testes-estatísticos.html"><a href="testes-estatísticos.html#teste-t-de-student"><i class="fa fa-check"></i><b>7.1</b> Teste t de Student</a><ul>
<li class="chapter" data-level="7.1.1" data-path="testes-estatísticos.html"><a href="testes-estatísticos.html#para-uma-média"><i class="fa fa-check"></i><b>7.1.1</b> Para uma média</a></li>
<li class="chapter" data-level="7.1.2" data-path="testes-estatísticos.html"><a href="testes-estatísticos.html#para-duas-médias-independentes"><i class="fa fa-check"></i><b>7.1.2</b> Para duas médias independentes</a></li>
<li class="chapter" data-level="7.1.3" data-path="testes-estatísticos.html"><a href="testes-estatísticos.html#para-duas-médias-dependentes"><i class="fa fa-check"></i><b>7.1.3</b> Para duas médias dependentes</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="testes-estatísticos.html"><a href="testes-estatísticos.html#teste-de-variância"><i class="fa fa-check"></i><b>7.2</b> Teste de variância</a><ul>
<li class="chapter" data-level="7.2.1" data-path="testes-estatísticos.html"><a href="testes-estatísticos.html#usando-o-teste-de-f"><i class="fa fa-check"></i><b>7.2.1</b> Usando o teste de F</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="testes-estatísticos.html"><a href="testes-estatísticos.html#teste-para-a-normalidade---shapiro.test"><i class="fa fa-check"></i><b>7.3</b> Teste para a normalidade - <code>shapiro.test()</code></a></li>
<li class="chapter" data-level="7.4" data-path="testes-estatísticos.html"><a href="testes-estatísticos.html#teste-u-de-mann-whitney"><i class="fa fa-check"></i><b>7.4</b> Teste U de Mann-Whitney</a></li>
<li class="chapter" data-level="7.5" data-path="testes-estatísticos.html"><a href="testes-estatísticos.html#covariância-e-correlação"><i class="fa fa-check"></i><b>7.5</b> Covariância e Correlação</a></li>
<li class="chapter" data-level="7.6" data-path="testes-estatísticos.html"><a href="testes-estatísticos.html#outros-testes"><i class="fa fa-check"></i><b>7.6</b> Outros testes</a><ul>
<li class="chapter" data-level="7.6.1" data-path="testes-estatísticos.html"><a href="testes-estatísticos.html#hydrogof"><i class="fa fa-check"></i><b>7.6.1</b> hydroGOF</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="analise-de-variância-anova.html"><a href="analise-de-variância-anova.html"><i class="fa fa-check"></i><b>8</b> Analise de variância (ANOVA)</a><ul>
<li class="chapter" data-level="8.1" data-path="analise-de-variância-anova.html"><a href="analise-de-variância-anova.html#delineamento-inteiramente-casualizado"><i class="fa fa-check"></i><b>8.1</b> Delineamento inteiramente casualizado</a><ul>
<li class="chapter" data-level="8.1.1" data-path="analise-de-variância-anova.html"><a href="analise-de-variância-anova.html#análise-de-experimento-em-dic"><i class="fa fa-check"></i><b>8.1.1</b> Análise de experimento em DIC</a></li>
<li class="chapter" data-level="8.1.2" data-path="analise-de-variância-anova.html"><a href="analise-de-variância-anova.html#análise-de-variância"><i class="fa fa-check"></i><b>8.1.2</b> Análise de variância</a></li>
<li class="chapter" data-level="8.1.3" data-path="analise-de-variância-anova.html"><a href="analise-de-variância-anova.html#transformação-de-dados"><i class="fa fa-check"></i><b>8.1.3</b> Transformação de dados</a></li>
<li class="chapter" data-level="8.1.4" data-path="analise-de-variância-anova.html"><a href="analise-de-variância-anova.html#aplicando-teste-de-tukey-para-comparar-médias"><i class="fa fa-check"></i><b>8.1.4</b> Aplicando teste de Tukey para comparar médias</a></li>
<li class="chapter" data-level="8.1.5" data-path="analise-de-variância-anova.html"><a href="analise-de-variância-anova.html#aplicando-teste-para-agrupar-médias"><i class="fa fa-check"></i><b>8.1.5</b> Aplicando teste para agrupar médias</a></li>
<li class="chapter" data-level="8.1.6" data-path="analise-de-variância-anova.html"><a href="analise-de-variância-anova.html#referência-4"><i class="fa fa-check"></i><b>8.1.6</b> Referência</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="analise-de-variância-anova.html"><a href="analise-de-variância-anova.html#delineamento-em-bloco-casualizado"><i class="fa fa-check"></i><b>8.2</b> Delineamento em bloco casualizado</a><ul>
<li class="chapter" data-level="8.2.1" data-path="analise-de-variância-anova.html"><a href="analise-de-variância-anova.html#análise-de-experimento-dbc"><i class="fa fa-check"></i><b>8.2.1</b> Análise de experimento DBC</a></li>
<li class="chapter" data-level="8.2.2" data-path="analise-de-variância-anova.html"><a href="analise-de-variância-anova.html#pacote-para-analise-de-experimentos"><i class="fa fa-check"></i><b>8.2.2</b> Pacote para analise de experimentos</a></li>
<li class="chapter" data-level="8.2.3" data-path="analise-de-variância-anova.html"><a href="analise-de-variância-anova.html#teste-não-parametrico"><i class="fa fa-check"></i><b>8.2.3</b> Teste não parametrico</a></li>
<li class="chapter" data-level="8.2.4" data-path="analise-de-variância-anova.html"><a href="analise-de-variância-anova.html#exercicio-1"><i class="fa fa-check"></i><b>8.2.4</b> Exercicio 1</a></li>
<li class="chapter" data-level="8.2.5" data-path="analise-de-variância-anova.html"><a href="analise-de-variância-anova.html#referência-5"><i class="fa fa-check"></i><b>8.2.5</b> Referência</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="analise-de-variância-anova.html"><a href="analise-de-variância-anova.html#quadrado-latino"><i class="fa fa-check"></i><b>8.3</b> Quadrado Latino</a><ul>
<li class="chapter" data-level="8.3.1" data-path="analise-de-variância-anova.html"><a href="analise-de-variância-anova.html#banco-de-dados"><i class="fa fa-check"></i><b>8.3.1</b> Banco de dados</a></li>
<li class="chapter" data-level="8.3.2" data-path="analise-de-variância-anova.html"><a href="analise-de-variância-anova.html#exercicios"><i class="fa fa-check"></i><b>8.3.2</b> Exercicios</a></li>
<li class="chapter" data-level="8.3.3" data-path="analise-de-variância-anova.html"><a href="analise-de-variância-anova.html#exercicio-para-entregar"><i class="fa fa-check"></i><b>8.3.3</b> Exercicio para entregar</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="analise-de-variância-anova.html"><a href="analise-de-variância-anova.html#regressão-linear-simples"><i class="fa fa-check"></i><b>8.4</b> Regressão Linear simples</a></li>
<li class="chapter" data-level="8.5" data-path="analise-de-variância-anova.html"><a href="analise-de-variância-anova.html#regressão-linear-multipla"><i class="fa fa-check"></i><b>8.5</b> Regressão Linear Multipla</a><ul>
<li class="chapter" data-level="8.5.1" data-path="analise-de-variância-anova.html"><a href="analise-de-variância-anova.html#referência-6"><i class="fa fa-check"></i><b>8.5.1</b> Referência</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="analise-de-variância-anova.html"><a href="analise-de-variância-anova.html#regressão-não-linear"><i class="fa fa-check"></i><b>8.6</b> Regressão não linear</a><ul>
<li class="chapter" data-level="8.6.1" data-path="analise-de-variância-anova.html"><a href="analise-de-variância-anova.html#curva-de-retenção-de-água-no-solo"><i class="fa fa-check"></i><b>8.6.1</b> Curva de retenção de água no solo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="multivariada.html"><a href="multivariada.html"><i class="fa fa-check"></i><b>9</b> Multivariada</a></li>
<li class="chapter" data-level="10" data-path="dados-climáticos-1.html"><a href="dados-climáticos-1.html"><i class="fa fa-check"></i><b>10</b> Dados climáticos</a><ul>
<li class="chapter" data-level="10.1" data-path="dados-climáticos-1.html"><a href="dados-climáticos-1.html#precipitação-pluvial"><i class="fa fa-check"></i><b>10.1</b> Precipitação pluvial</a><ul>
<li class="chapter" data-level="10.1.1" data-path="dados-climáticos-1.html"><a href="dados-climáticos-1.html#análise-anual-dos-dados"><i class="fa fa-check"></i><b>10.1.1</b> Análise anual dos dados</a></li>
<li class="chapter" data-level="10.1.2" data-path="dados-climáticos-1.html"><a href="dados-climáticos-1.html#análise-mensal-dos-dados---boxplot"><i class="fa fa-check"></i><b>10.1.2</b> Análise mensal dos dados - BOXPLOT</a></li>
<li class="chapter" data-level="10.1.3" data-path="dados-climáticos-1.html"><a href="dados-climáticos-1.html#análise-sazonal"><i class="fa fa-check"></i><b>10.1.3</b> Análise sazonal</a></li>
<li class="chapter" data-level="10.1.4" data-path="dados-climáticos-1.html"><a href="dados-climáticos-1.html#alguns-índices-extremos"><i class="fa fa-check"></i><b>10.1.4</b> Alguns índices extremos</a></li>
<li class="chapter" data-level="10.1.5" data-path="dados-climáticos-1.html"><a href="dados-climáticos-1.html#precipitaçao-total-chuva"><i class="fa fa-check"></i><b>10.1.5</b> Precipitaçao total chuva</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="dados-climáticos-1.html"><a href="dados-climáticos-1.html#evapotranspiração"><i class="fa fa-check"></i><b>10.2</b> Evapotranspiração</a><ul>
<li class="chapter" data-level="10.2.1" data-path="dados-climáticos-1.html"><a href="dados-climáticos-1.html#pacote-evapotranspiration"><i class="fa fa-check"></i><b>10.2.1</b> Pacote Evapotranspiration</a></li>
<li class="chapter" data-level="10.2.2" data-path="dados-climáticos-1.html"><a href="dados-climáticos-1.html#referência-7"><i class="fa fa-check"></i><b>10.2.2</b> Referência</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="dados-climáticos-1.html"><a href="dados-climáticos-1.html#dados-temporais-no-r"><i class="fa fa-check"></i><b>10.3</b> Dados temporais no R</a></li>
<li class="chapter" data-level="10.4" data-path="dados-climáticos-1.html"><a href="dados-climáticos-1.html#datas-no-r"><i class="fa fa-check"></i><b>10.4</b> Datas no R</a></li>
<li class="chapter" data-level="10.5" data-path="dados-climáticos-1.html"><a href="dados-climáticos-1.html#teste-mann-kendall-para-tendência"><i class="fa fa-check"></i><b>10.5</b> Teste Mann-Kendall para Tendência</a><ul>
<li class="chapter" data-level="10.5.1" data-path="dados-climáticos-1.html"><a href="dados-climáticos-1.html#referência-8"><i class="fa fa-check"></i><b>10.5.1</b> Referência</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="sensoriamento-remoto.html"><a href="sensoriamento-remoto.html"><i class="fa fa-check"></i><b>11</b> Sensoriamento remoto</a><ul>
<li class="chapter" data-level="11.1" data-path="sensoriamento-remoto.html"><a href="sensoriamento-remoto.html#imagens-de-rpas"><i class="fa fa-check"></i><b>11.1</b> Imagens de RPAs</a></li>
<li class="chapter" data-level="11.2" data-path="sensoriamento-remoto.html"><a href="sensoriamento-remoto.html#imagens-de-satélites"><i class="fa fa-check"></i><b>11.2</b> Imagens de satélites</a></li>
<li class="chapter" data-level="11.3" data-path="sensoriamento-remoto.html"><a href="sensoriamento-remoto.html#curvas-de-nível-e-modelo-3d-a-partir-do-modelo-digital-de-elevação"><i class="fa fa-check"></i><b>11.3</b> Curvas de nível e modelo 3D a partir do Modelo Digital de Elevação</a></li>
<li class="chapter" data-level="11.4" data-path="sensoriamento-remoto.html"><a href="sensoriamento-remoto.html#lidar"><i class="fa fa-check"></i><b>11.4</b> LIDAR</a></li>
<li class="chapter" data-level="11.5" data-path="sensoriamento-remoto.html"><a href="sensoriamento-remoto.html#modelo-digital-de-elevação-mde"><i class="fa fa-check"></i><b>11.5</b> Modelo Digital de Elevação MDE</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Uso do sistema R para análise de dados</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="analise-de-variância-anova" class="section level1">
<h1><span class="header-section-number"> 8</span> Analise de variância (ANOVA)</h1>
<p>Estudos estatísticos contemporâneos contemplam a análise de variância tendo em vista que este procedimento permite identificar e quantificar as variações ocorridas em um experimento, discriminando a parte da variação associada ao modelo pelo qual o experimento foi procedido da variação que se dá devido ao acaso.
No R encontram-se diversos procedimentos para se executar a ANOVA. A tabela abaixo mostra alguns modelos e suas usuais formulações:</p>
<table>
<thead>
<tr class="header">
<th>Modelo</th>
<th>Fórmula</th>
<th>Comentário</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>DIC</td>
<td>y~t</td>
<td>t é um fator</td>
</tr>
<tr class="even">
<td>DBC</td>
<td>y~t+b</td>
<td>t e b são fatores</td>
</tr>
<tr class="odd">
<td>DQL</td>
<td>y~t+l+c</td>
<td>t, l e c são fatores</td>
</tr>
<tr class="even">
<td>Fatorial/ DIC</td>
<td>y~N*P</td>
<td>igual a N + P + N:P</td>
</tr>
<tr class="odd">
<td>Fatorial/ DBC</td>
<td>y~b+N*P</td>
<td>igual a b+N+P+N:P</td>
</tr>
<tr class="even">
<td>Regressão linear simples</td>
<td>y~x</td>
<td>x é uma variável exploratória</td>
</tr>
<tr class="odd">
<td>Regressão quadrática</td>
<td>y~x+x2</td>
<td>x2 é um objeto x2&lt;-x^2</td>
</tr>
</tbody>
</table>
<p>Os modelos de análise de variância simples podem ser trabalhados também a partir da função <code>lm()</code> simplesmente indicando um fator como variável independente. No entanto, existem outras funções que também realizam análises de variância para casos específicos (como a <code>aov()</code> para amostras balanceadas) ou modelos lineares mais complexos como análise de modelos mistos ou hierarquicas função <code>lme()</code> do pacote nlme e modelos não lineares <code>nls()</code> e <code>glm()</code> para ANOVA, com estrutura de erros especificada.</p>
<div id="delineamento-inteiramente-casualizado" class="section level2">
<h2><span class="header-section-number">8.1</span> Delineamento inteiramente casualizado</h2>
<p>O delineamento inteiramente casualizado é o mais simples de todos os delineamentos experimentais.</p>
<p>Este delineamento apresenta as seguintes caracterítiscas:</p>
<ul>
<li><p>Utiliza apenas os princópios da <em>repetição</em> e da <em>casualização</em>, deixando de lado o princípio do <em>controle local</em>, e, portanto, as repetições não são organizadas em blocos;</p></li>
<li><p>Os tratamentos são designados às parcelas de forma inteiramente casual, com números iguais ou diferentes repetições por tratamento.</p></li>
</ul>
<p><strong>Vantagens em relações a outros delineamentos</strong></p>
<ul>
<li>é um delineamento bastante flexível, visto que o número de tratamentos e de repetições depende apenas do número de parcelas disponíveis;</li>
<li>o número de repetições pode ser diferente de um tratamento para outro;</li>
<li>a análise estatística é simples, mesmo quando o número de repetições por tratamento é variável;</li>
<li>o número de grau de liberdade para o resíduo é o maior possível;</li>
</ul>
<p><strong>Desvantagens em relações a outros delineamentos</strong></p>
<ul>
<li>exige homogeneidade total das condições experimentais;</li>
<li>pode conduzir a uma estimativa de variância residual bastante alta, uma vez que, não se aplica o controle local;</li>
</ul>
<p>Este delineamento é mais utilizado em experimentos de laboratório e nos ensaios com vasos, realizados dentro de casas de vegetação, nos quais as condições experimentais podem ser controladas. Nos experimentos realizados com vasos, estes devem ser cte mudados de posição, de forma interamente casual.</p>
<div id="análise-de-experimento-em-dic" class="section level3">
<h3><span class="header-section-number">8.1.1</span> Análise de experimento em DIC</h3>
<p>Dados de um experimento visando controle de pulgão (<em>Aphis gossypii Glover</em>) em cultura de pepino, instalado em delineamento inteiramente casualizado com 6 repetições. A resposta observada foi o número de pulgões após a aplicação de produtos indicados para seu controle.
O primeiro passo é ler os dados.</p>
<p>Importando dados:</p>
<div class="sourceCode" id="cb488"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb488-1" title="1">dados &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;https://www.dropbox.com/s/jjyo8dhyy0qt3ft/BanzattoQd3.2.1.txt?dl=1&quot;</span>) </a></code></pre></div>
<p>Conferir se temos fatores para fazer a análise de variância:</p>
<div class="sourceCode" id="cb489"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb489-1" title="1"><span class="kw">str</span>(dados)</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    30 obs. of  3 variables:
##  $ trat   : Factor w/ 5 levels &quot;Azinfos etilico&quot;,..: 5 1 3 4 2 5 1 3 4 2 ...
##  $ rept   : int  1 1 1 1 1 2 2 2 2 2 ...
##  $ pulgoes: int  2370 1282 562 173 193 1687 1527 321 127 71 ...</code></pre>
<p>Lembramos que pulgões deve ter conteúdo numérico e trat deve ser fator:</p>
<div class="sourceCode" id="cb491"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb491-1" title="1">dados<span class="op">$</span>trat&lt;-<span class="kw">as.factor</span>(dados<span class="op">$</span>trat)</a>
<a class="sourceLine" id="cb491-2" title="2">dados<span class="op">$</span>pulgoes&lt;-<span class="kw">as.numeric</span>(dados<span class="op">$</span>pulgoes)</a></code></pre></div>
<p>Verificação gráfica**
É importante notar que as barras simplesmente refletem a variância dos dados dentro de cada tratamento e não são adequadas para detectar diferenças entre tratamentos:</p>
<div class="sourceCode" id="cb492"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb492-1" title="1"><span class="kw">plot</span>(dados<span class="op">$</span>trat, dados<span class="op">$</span>pulgoes)</a></code></pre></div>
<p><img src="TudodoR_files/figure-html/unnamed-chunk-283-1.png" width="672" /></p>
</div>
<div id="análise-de-variância" class="section level3">
<h3><span class="header-section-number">8.1.2</span> Análise de variância</h3>
<p>Fazendo a análise de variância:</p>
<div class="sourceCode" id="cb493"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb493-1" title="1">m0 &lt;-<span class="st"> </span><span class="kw">lm</span> (dados<span class="op">$</span>pulgoes <span class="op">~</span><span class="st"> </span>dados<span class="op">$</span>trat)</a></code></pre></div>
<div class="sourceCode" id="cb494"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb494-1" title="1"><span class="kw">anova</span>(m0)</a></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: dados$pulgoes
##            Df   Sum Sq Mean Sq F value    Pr(&gt;F)    
## dados$trat  4 23145259 5786315   81.79 5.505e-14 ***
## Residuals  25  1768644   70746                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Extraindo o coeficiênte de variação:</p>
<div class="sourceCode" id="cb496"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb496-1" title="1"><span class="kw">require</span>(agricolae)</a></code></pre></div>
<pre><code>## Loading required package: agricolae</code></pre>
<div class="sourceCode" id="cb498"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb498-1" title="1"><span class="kw">cv.model</span>(m0)</a></code></pre></div>
<pre><code>## [1] 30.73619</code></pre>
<p>Análise gráfica dos resíduos:</p>
<div class="sourceCode" id="cb500"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb500-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb500-2" title="2"><span class="kw">plot</span>(m0)</a></code></pre></div>
<p><img src="TudodoR_files/figure-html/unnamed-chunk-287-1.png" width="672" /></p>
<p>Analisando a figura acima sugere que o principal problema deste conjunto de dados pode ser a heterosdasticidade. A variabilidade dos erros apresentam um forma de cone.</p>
<p>Teste das pressuposições da análise de variância**:</p>
<div class="sourceCode" id="cb501"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb501-1" title="1"><span class="co"># Teste de Bartllet para homocedasticidade</span></a>
<a class="sourceLine" id="cb501-2" title="2"><span class="kw">bartlett.test</span>(m0<span class="op">$</span>res, dados<span class="op">$</span>trat)</a></code></pre></div>
<pre><code>## 
##  Bartlett test of homogeneity of variances
## 
## data:  m0$res and dados$trat
## Bartlett&#39;s K-squared = 29.586, df = 4, p-value = 5.942e-06</code></pre>
<p>Como observamos uma significância estatística neste resultado, devemos rejeitar a hipótese nula de que as variâncias sejam as mesmas em todos os níveis do fator.</p>
<p>Teste de Shapiro-Wilk para Normalidade:</p>
<div class="sourceCode" id="cb503"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb503-1" title="1"><span class="kw">shapiro.test</span>(m0<span class="op">$</span>res)</a></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  m0$res
## W = 0.89608, p-value = 0.006742</code></pre>
</div>
<div id="transformação-de-dados" class="section level3">
<h3><span class="header-section-number">8.1.3</span> Transformação de dados</h3>
<p>Tranformação de dados é uma das possíveis formas de contornar o problema de dados que não obedecem os pressupostos da análise de variância. Vamos ver como isto poder ser feito com o programa R.</p>
<p>Nos resultados acima vemos que a homogeneidade de variâncias foi rejeitada. Para tentar contornar o problema podemos utilizar catálogos de transformação:</p>
<ul>
<li><p>Transformação de raiz quadrada: frequentemente utilizada para dados de contagens, que geralmente seguem a distribuição de Poison, na qual a média é igual a variância. Quando ocorrem zeros ou valores baixos (menores que 10 ou 15), as transformação recomendadas são raiz quadrada + 0,5 ou 1,0.</p></li>
<li><p>Transformação angular: recomendável para dados expressos em porcentagens, que geralmente segue distribuição binomial.</p></li>
<li><p>Transformação logarítima: utilizada quando é constatada certa proporcionalidade entre as médias e os desvios padrões dos diversos tratamentos:</p></li>
</ul>
<div class="sourceCode" id="cb505"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb505-1" title="1">m1 &lt;-<span class="st"> </span><span class="kw">lm</span> (<span class="kw">log</span>(dados<span class="op">$</span>pulgoes) <span class="op">~</span><span class="st"> </span>dados<span class="op">$</span>trat)</a></code></pre></div>
<div id="transformação-de-dados-box-cox" class="section level4">
<h4><span class="header-section-number">8.1.3.1</span> Transformação de dados BOX-COX</h4>
<p>Para tentar contornar o problema vamos usar a transformação Box-Cox, que consiste em transformar os dados de acordo com uma expressão.</p>
<p>A função <code>boxcox(</code>) do pacote MASS calcula a verossimilhança perfilhada do parâmetro. Devemos escolher o valor que maximiza esta função. Nos comandos a seguir começamos carregando o pacote MASS e depois obtemos o gráfico da verossimilhança perfilhada. Como estamos interessados no máximo fazermos um novo gráfico com um zoom na região de interesse:</p>
<div class="sourceCode" id="cb506"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb506-1" title="1"><span class="kw">require</span>(MASS) </a></code></pre></div>
<pre><code>## Loading required package: MASS</code></pre>
<div class="sourceCode" id="cb508"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb508-1" title="1">  <span class="kw">boxcox</span>(m0)</a></code></pre></div>
<p><img src="TudodoR_files/figure-html/unnamed-chunk-291-1.png" width="672" /></p>
<div class="sourceCode" id="cb509"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb509-1" title="1">  <span class="co">#Com zoom</span></a>
<a class="sourceLine" id="cb509-2" title="2">  <span class="kw">boxcox</span>(m0, <span class="dt">lam =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">10</span>))</a></code></pre></div>
<p><img src="TudodoR_files/figure-html/unnamed-chunk-291-2.png" width="672" /></p>
<div class="sourceCode" id="cb510"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb510-1" title="1">  <span class="kw">boxcox</span>(m0)</a>
<a class="sourceLine" id="cb510-2" title="2">  <span class="kw">abline</span>(<span class="dt">v=</span><span class="fl">0.2</span>)</a>
<a class="sourceLine" id="cb510-3" title="3">  <span class="kw">locator</span>()</a></code></pre></div>
<p><img src="TudodoR_files/figure-html/unnamed-chunk-292-1.png" width="672" /></p>
</div>
<div id="análise-de-variância---ajuste-com-a-variável-transformada." class="section level4">
<h4><span class="header-section-number">8.1.3.2</span> Análise de variância - Ajuste com a variável transformada.</h4>
<div class="sourceCode" id="cb511"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb511-1" title="1">m1 &lt;-<span class="st"> </span><span class="kw">lm</span> (dados<span class="op">$</span>pulgoes<span class="op">^</span><span class="fl">0.2</span> <span class="op">~</span><span class="st"> </span>dados<span class="op">$</span>trat, <span class="dt">data =</span> dados)</a></code></pre></div>
<p><strong>análise gráfica dos resíduos</strong></p>
<div class="sourceCode" id="cb512"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb512-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb512-2" title="2"><span class="kw">plot</span>(m1)</a></code></pre></div>
<p><img src="TudodoR_files/figure-html/unnamed-chunk-294-1.png" width="672" /></p>
<p>Os pressupostos foram atendindos</p>
<p>Teste de Shapiro-Wilk para Normalidade:</p>
<div class="sourceCode" id="cb513"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb513-1" title="1"><span class="kw">shapiro.test</span>(m1<span class="op">$</span>res)</a></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  m1$res
## W = 0.97288, p-value = 0.6207</code></pre>
<p>Teste de Bartllet para homocedasticidade:</p>
<div class="sourceCode" id="cb515"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb515-1" title="1"><span class="kw">bartlett.test</span>(m1<span class="op">$</span>res, dados<span class="op">$</span>trat)</a></code></pre></div>
<pre><code>## 
##  Bartlett test of homogeneity of variances
## 
## data:  m1$res and dados$trat
## Bartlett&#39;s K-squared = 2.7641, df = 4, p-value = 0.598</code></pre>
<p>Resumo do modelo ajustado - Contraste :</p>
<div class="sourceCode" id="cb517"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb517-1" title="1"><span class="kw">summary</span>(m1)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = dados$pulgoes^0.2 ~ dados$trat, data = dados)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.33971 -0.10602 -0.02286  0.14069  0.44317 
## 
## Coefficients:
##                                Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                     4.02268    0.08709  46.191  &lt; 2e-16 ***
## dados$tratDiazinon 60CE        -1.60093    0.12316 -12.999 1.27e-12 ***
## dados$tratSupracid 40CE dose 1 -0.55418    0.12316  -4.500 0.000136 ***
## dados$tratSupracid 40CE dose 2 -1.28606    0.12316 -10.442 1.33e-10 ***
## dados$tratTestemunha            0.73703    0.12316   5.984 3.00e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.2133 on 25 degrees of freedom
## Multiple R-squared:   0.95,  Adjusted R-squared:  0.942 
## F-statistic: 118.8 on 4 and 25 DF,  p-value: 6.978e-16</code></pre>
<p>Resumo do modelo ajustado - Contraste em relação a testemunha:</p>
<div class="sourceCode" id="cb519"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb519-1" title="1">dados<span class="op">$</span>trat &lt;-<span class="st"> </span><span class="kw">relevel</span>(dados<span class="op">$</span>trat, <span class="st">&quot;Testemunha&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb520"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb520-1" title="1">m1 &lt;-<span class="st"> </span><span class="kw">lm</span> (dados<span class="op">$</span>pulgoes<span class="op">^</span><span class="fl">0.2</span> <span class="op">~</span><span class="st"> </span>dados<span class="op">$</span>trat, <span class="dt">data =</span> dados)</a></code></pre></div>
<div class="sourceCode" id="cb521"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb521-1" title="1"><span class="kw">summary</span>(m1)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = dados$pulgoes^0.2 ~ dados$trat, data = dados)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.33971 -0.10602 -0.02286  0.14069  0.44317 
## 
## Coefficients:
##                                Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                     4.75972    0.08709  54.654  &lt; 2e-16 ***
## dados$tratAzinfos etilico      -0.73703    0.12316  -5.984 3.00e-06 ***
## dados$tratDiazinon 60CE        -2.33797    0.12316 -18.983 2.31e-16 ***
## dados$tratSupracid 40CE dose 1 -1.29122    0.12316 -10.484 1.23e-10 ***
## dados$tratSupracid 40CE dose 2 -2.02310    0.12316 -16.426 6.62e-15 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.2133 on 25 degrees of freedom
## Multiple R-squared:   0.95,  Adjusted R-squared:  0.942 
## F-statistic: 118.8 on 4 and 25 DF,  p-value: 6.978e-16</code></pre>
</div>
</div>
<div id="aplicando-teste-de-tukey-para-comparar-médias" class="section level3">
<h3><span class="header-section-number">8.1.4</span> Aplicando teste de Tukey para comparar médias</h3>
<p>No R, o teste de Tukey é apresentado através de intervalos de confiança. A interpretação é: se o intervalo de confiança para a diferença entre duas médias não incluir o valor zero, significa que se rejeita a hipótese nula, caso contrário, não se rejeita. O resultado pode ser visto através de uma tabela e/ou graficamente:</p>
<div class="sourceCode" id="cb523"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb523-1" title="1">m1 &lt;-<span class="st"> </span><span class="kw">aov</span> (dados<span class="op">$</span>pulgoes<span class="op">^</span><span class="fl">0.2</span> <span class="op">~</span><span class="st"> </span>dados<span class="op">$</span>trat, <span class="dt">data =</span> dados)</a></code></pre></div>
<div class="sourceCode" id="cb524"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb524-1" title="1">dados.tu &lt;-<span class="st"> </span><span class="kw">TukeyHSD</span> (m1)</a></code></pre></div>
<div class="sourceCode" id="cb525"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb525-1" title="1"><span class="kw">print</span>(dados.tu)</a></code></pre></div>
<pre><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = dados$pulgoes^0.2 ~ dados$trat, data = dados)
## 
## $`dados$trat`
##                                                 diff         lwr        upr
## Azinfos etilico-Testemunha                -0.7370340 -1.09874544 -0.3753225
## Diazinon 60CE-Testemunha                  -2.3379681 -2.69967961 -1.9762567
## Supracid 40CE dose 1-Testemunha           -1.2912155 -1.65292701 -0.9295041
## Supracid 40CE dose 2-Testemunha           -2.0230984 -2.38480982 -1.6613869
## Diazinon 60CE-Azinfos etilico             -1.6009342 -1.96264562 -1.2392227
## Supracid 40CE dose 1-Azinfos etilico      -0.5541816 -0.91589302 -0.1924701
## Supracid 40CE dose 2-Azinfos etilico      -1.2860644 -1.64777584 -0.9243529
## Supracid 40CE dose 1-Diazinon 60CE         1.0467526  0.68504114  1.4084641
## Supracid 40CE dose 2-Diazinon 60CE         0.3148698 -0.04684168  0.6765812
## Supracid 40CE dose 2-Supracid 40CE dose 1 -0.7318828 -1.09359428 -0.3701714
##                                               p adj
## Azinfos etilico-Testemunha                0.0000277
## Diazinon 60CE-Testemunha                  0.0000000
## Supracid 40CE dose 1-Testemunha           0.0000000
## Supracid 40CE dose 2-Testemunha           0.0000000
## Diazinon 60CE-Azinfos etilico             0.0000000
## Supracid 40CE dose 1-Azinfos etilico      0.0011809
## Supracid 40CE dose 2-Azinfos etilico      0.0000000
## Supracid 40CE dose 1-Diazinon 60CE        0.0000001
## Supracid 40CE dose 2-Diazinon 60CE        0.1099096
## Supracid 40CE dose 2-Supracid 40CE dose 1 0.0000307</code></pre>
<div class="sourceCode" id="cb527"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb527-1" title="1"><span class="kw">plot</span>(dados.tu)</a></code></pre></div>
<p><img src="TudodoR_files/figure-html/unnamed-chunk-304-1.png" width="672" /></p>
<p><strong>Teste Tukey com pacote Agricolae</strong></p>
<div class="sourceCode" id="cb528"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb528-1" title="1"><span class="kw">library</span>(agricolae)</a></code></pre></div>
<div class="sourceCode" id="cb529"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb529-1" title="1"><span class="kw">summary</span>(m1)</a></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## dados$trat   4 21.629   5.407   118.8 6.98e-16 ***
## Residuals   25  1.138   0.046                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb531"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb531-1" title="1">tu &lt;-<span class="st"> </span><span class="kw">HSD.test</span>(<span class="dt">y =</span> dados<span class="op">$</span>pulgoes<span class="op">^</span><span class="fl">0.2</span>,</a>
<a class="sourceLine" id="cb531-2" title="2">         <span class="dt">trt =</span> dados<span class="op">$</span>trat,</a>
<a class="sourceLine" id="cb531-3" title="3">         <span class="dt">MSerror =</span> <span class="kw">deviance</span>(m1)<span class="op">/</span><span class="kw">df.residual</span>(m1), <span class="co">#quadrado médio do residuo</span></a>
<a class="sourceLine" id="cb531-4" title="4">         <span class="dt">DFerror =</span> <span class="kw">df.residual</span>(m1),</a>
<a class="sourceLine" id="cb531-5" title="5">         <span class="dt">console =</span> T)</a></code></pre></div>
<pre><code>## 
## Study: dados$pulgoes^0.2 ~ dados$trat
## 
## HSD Test for dados$pulgoes^0.2 
## 
## Mean Square Error:  0.04550677 
## 
## dados$trat,  means
## 
##                      dados.pulgoes.0.2       std r      Min      Max
## Azinfos etilico               4.022682 0.1967278 6 3.830812 4.332792
## Diazinon 60CE                 2.421748 0.2492525 6 2.131526 2.864913
## Supracid 40CE dose 1          3.468500 0.2678917 6 3.163821 3.846471
## Supracid 40CE dose 2          2.736617 0.1264052 6 2.634879 2.959410
## Testemunha                    4.759716 0.1973855 6 4.420008 4.965939
## 
## Alpha: 0.05 ; DF Error: 25 
## Critical Value of Studentized Range: 4.153363 
## 
## Minimun Significant Difference: 0.3617115 
## 
## Treatments with the same letter are not significantly different.
## 
##                      dados$pulgoes^0.2 groups
## Testemunha                    4.759716      a
## Azinfos etilico               4.022682      b
## Supracid 40CE dose 1          3.468500      c
## Supracid 40CE dose 2          2.736617      d
## Diazinon 60CE                 2.421748      d</code></pre>
<div class="sourceCode" id="cb533"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb533-1" title="1"><span class="kw">str</span>(tu)</a></code></pre></div>
<pre><code>## List of 5
##  $ statistics:&#39;data.frame&#39;:  1 obs. of  5 variables:
##   ..$ MSerror: num 0.0455
##   ..$ Df     : int 25
##   ..$ Mean   : num 3.48
##   ..$ CV     : num 6.13
##   ..$ MSD    : num 0.362
##  $ parameters:&#39;data.frame&#39;:  1 obs. of  5 variables:
##   ..$ test            : Factor w/ 1 level &quot;Tukey&quot;: 1
##   ..$ name.t          : Factor w/ 1 level &quot;dados$trat&quot;: 1
##   ..$ ntr             : int 5
##   ..$ StudentizedRange: num 4.15
##   ..$ alpha           : num 0.05
##  $ means     :&#39;data.frame&#39;:  5 obs. of  8 variables:
##   ..$ dados$pulgoes^0.2: num [1:5] 4.02 2.42 3.47 2.74 4.76
##   ..$ std              : num [1:5] 0.197 0.249 0.268 0.126 0.197
##   ..$ r                : int [1:5] 6 6 6 6 6
##   ..$ Min              : num [1:5] 3.83 2.13 3.16 2.63 4.42
##   ..$ Max              : num [1:5] 4.33 2.86 3.85 2.96 4.97
##   ..$ Q25              : num [1:5] 3.88 2.3 3.24 2.65 4.7
##   ..$ Q50              : num [1:5] 3.96 2.38 3.5 2.69 4.77
##   ..$ Q75              : num [1:5] 4.14 2.47 3.61 2.78 4.9
##  $ comparison: NULL
##  $ groups    :&#39;data.frame&#39;:  5 obs. of  2 variables:
##   ..$ dados$pulgoes^0.2: num [1:5] 4.76 4.02 3.47 2.74 2.42
##   ..$ groups           : Factor w/ 4 levels &quot;a&quot;,&quot;b&quot;,&quot;c&quot;,&quot;d&quot;: 1 2 3 4 4
##  - attr(*, &quot;class&quot;)= chr &quot;group&quot;</code></pre>
<div class="sourceCode" id="cb535"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb535-1" title="1">tu<span class="op">$</span>groups</a></code></pre></div>
<pre><code>##                      dados$pulgoes^0.2 groups
## Testemunha                    4.759716      a
## Azinfos etilico               4.022682      b
## Supracid 40CE dose 1          3.468500      c
## Supracid 40CE dose 2          2.736617      d
## Diazinon 60CE                 2.421748      d</code></pre>
<div class="sourceCode" id="cb537"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb537-1" title="1"><span class="kw">write.table</span>(tu<span class="op">$</span>groups,</a>
<a class="sourceLine" id="cb537-2" title="2">            <span class="st">&quot;tab.xls&quot;</span>,</a>
<a class="sourceLine" id="cb537-3" title="3">            <span class="dt">sep =</span> <span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>,</a>
<a class="sourceLine" id="cb537-4" title="4">            <span class="dt">quote =</span> F,</a>
<a class="sourceLine" id="cb537-5" title="5">            <span class="dt">row.names =</span> F)</a></code></pre></div>
</div>
<div id="aplicando-teste-para-agrupar-médias" class="section level3">
<h3><span class="header-section-number">8.1.5</span> Aplicando teste para agrupar médias</h3>
<p><strong>carregando a biblioteca necessária</strong></p>
<div class="sourceCode" id="cb538"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb538-1" title="1"><span class="co">#install.packages(&quot;laercio&quot;)</span></a>
<a class="sourceLine" id="cb538-2" title="2"><span class="kw">require</span>(laercio)</a></code></pre></div>
<pre><code>## Loading required package: laercio</code></pre>
<p>Teste de Duncan:</p>
<div class="sourceCode" id="cb540"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb540-1" title="1"><span class="kw">LDuncan</span> (m1, <span class="st">&quot;dados$trat&quot;</span>)</a></code></pre></div>
<pre><code>## 
##  DUNCAN TEST TO COMPARE MEANS 
##  
##  Confidence Level:  0.95 
##  Dependent Variable:  dados$pulgoes^0.2
##  Variation Coefficient:  6.126714 % 
##  
## 
##  Independent Variable:  dados$trat 
##   Factors              Means                 
##   Testemunha           4.75971565312899 a    
##   Azinfos etilico      4.02268167030532  b   
##   Supracid 40CE dose 1 3.46850010815533   c  
##   Supracid 40CE dose 2 2.73661729164913    d 
##   Diazinon 60CE        2.42174750727391     e</code></pre>
<div class="sourceCode" id="cb542"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb542-1" title="1"><span class="kw">LTukey</span> (m1, <span class="st">&quot;dados$trat&quot;</span>)</a></code></pre></div>
<pre><code>## 
##  TUKEY TEST TO COMPARE MEANS 
##  
##  Confidence level:  0.95 
##  Dependent variable:  dados$pulgoes^0.2
##  Variation Coefficient:  6.126714 % 
##  
## Independent variable:  dados$trat 
##   Factors              Means                
##   Testemunha           4.75971565312899 a   
##   Azinfos etilico      4.02268167030532  b  
##   Supracid 40CE dose 1 3.46850010815533   c 
##   Supracid 40CE dose 2 2.73661729164913    d
##   Diazinon 60CE        2.42174750727391    d
## 
## </code></pre>
<p>Pacote para análise de experimentos:</p>
<div class="sourceCode" id="cb544"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb544-1" title="1"><span class="kw">library</span>(ExpDes.pt)</a></code></pre></div>
<pre><code>## 
## Attaching package: &#39;ExpDes.pt&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:MASS&#39;:
## 
##     ginv</code></pre>
<pre><code>## The following objects are masked from &#39;package:agricolae&#39;:
## 
##     lastC, order.group, tapply.stat</code></pre>
<pre><code>## The following object is masked from &#39;package:stats&#39;:
## 
##     ccf</code></pre>
<p><strong>Recursos adicionais para comparações múltiplas</strong></p>
<p>Outros procedimentos serão implementados em pacotes contribuídos do R. Entre estes encontra-se os pacotes multcomp e multcompView que implementam diversos outros procedimentos e gráficos para visualizações dos resultados. Vale notar que estes pacotes devem ser instalados com a opção <code>dependencies=TRUE</code> para garantir plena funcionalidade pois suas funções dependem de diversos outros pacotes:</p>
<div class="sourceCode" id="cb549"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb549-1" title="1"><span class="co">#install.packages(&quot;multcompView&quot;, dep = TRUE) </span></a>
<a class="sourceLine" id="cb549-2" title="2"><span class="kw">require</span>(multcomp) </a></code></pre></div>
<pre><code>## Loading required package: multcomp</code></pre>
<pre><code>## Loading required package: mvtnorm</code></pre>
<pre><code>## Loading required package: survival</code></pre>
<pre><code>## Loading required package: TH.data</code></pre>
<pre><code>## 
## Attaching package: &#39;TH.data&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:MASS&#39;:
## 
##     geyser</code></pre>
<div class="sourceCode" id="cb556"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb556-1" title="1"><span class="kw">require</span>(multcompView)</a></code></pre></div>
<pre><code>## Loading required package: multcompView</code></pre>
<div class="sourceCode" id="cb558"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb558-1" title="1"><span class="kw">multcompBoxplot</span>(pulgoes <span class="op">~</span><span class="st"> </span>trat, <span class="dt">data =</span> dados, <span class="dt">compFn =</span> <span class="st">&quot;TukeyHSD&quot;</span>, <span class="dt">decreasing =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="TudodoR_files/figure-html/unnamed-chunk-316-1.png" width="672" /></p>
</div>
<div id="referência-4" class="section level3">
<h3><span class="header-section-number">8.1.6</span> Referência</h3>
<p>MELO, M. P.; PETERNELI, L. A. Conhecendo o R: Um visão mais que estatística. Viçosa, MG: UFV, 2013. 222p. Cap. 1.</p>
<p>BANZATTO, D. A; KRONKA, S. N. Experimentação agrícola. Jaboticabal, SP: FUNEP, 2006, 237p.</p>
<p>ZEVIANI, W. M. estatística Básica e Experimentação no R. 45p.</p>
<p><a href="http://www.leg.ufpr.br/~paulojus/" class="uri">http://www.leg.ufpr.br/~paulojus/</a></p>

</div>
</div>
<div id="delineamento-em-bloco-casualizado" class="section level2">
<h2><span class="header-section-number">8.2</span> Delineamento em bloco casualizado</h2>
<p>O delineamento em blocos casualizados (DBC) tem três princípios basicos de experimentação:</p>
<ul>
<li><p>repetição</p></li>
<li><p>casualização</p></li>
<li><p>controle local</p></li>
</ul>
<p>É o deliamento mais utilizado de todos os delineamentos. Ele é utilizado quando há heterogeneidade nas condições experimentais. Nesse caso divide-se o material experimental, ou amostra, em bloco homogêneos de forma a contemplar as diferenças entre grupos. A ANOVA associada a este modelo de experimento é também conhecida como <em>Two Way ANOVA</em>.</p>
<div id="análise-de-experimento-dbc" class="section level3">
<h3><span class="header-section-number">8.2.1</span> Análise de experimento DBC</h3>
<p>Resultados de um experimento instalado na Fazenda Chapadão, no município de Angatuba - SP. O delineamento experimental foi o de blocos casualizados, sendo as parcelas constituídas de 4 plantas espaçadas de 6 x 7 metros, com 12 anos de idade na época da instalação do experimento.</p>
<p>Importando dados:</p>
<div class="sourceCode" id="cb559"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb559-1" title="1">dados &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;https://www.dropbox.com/s/9woiye3ce9twp78/BanzattoQd4.5.2.txt?dl=1&quot;</span>) </a></code></pre></div>
<p>conferir se temos fatores para fazer a análise de variância:</p>
<div class="sourceCode" id="cb560"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb560-1" title="1"><span class="kw">str</span>(dados)</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    20 obs. of  3 variables:
##  $ promalin: Factor w/ 5 levels &quot;12.5&quot;,&quot;12.5+12.5&quot;,..: 1 3 4 2 5 1 3 4 2 5 ...
##  $ bloco   : Factor w/ 4 levels &quot;I&quot;,&quot;II&quot;,&quot;III&quot;,..: 1 1 1 1 1 2 2 2 2 2 ...
##  $ peso    : num  142 140 141 151 154 ...</code></pre>
<p>Lembramos que o <em>peso</em> deve ter conteúdo numérico e o <em>promalin</em> e <em>bloco</em> deve ser fator:</p>
<div class="sourceCode" id="cb562"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb562-1" title="1">dados<span class="op">$</span>promalin&lt;-<span class="kw">as.factor</span>(dados<span class="op">$</span>promalin)</a>
<a class="sourceLine" id="cb562-2" title="2">dados<span class="op">$</span>bloco&lt;-<span class="kw">as.numeric</span>(dados<span class="op">$</span>bloco)</a></code></pre></div>
<p>Verificação gráfica**:</p>
<div class="sourceCode" id="cb563"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb563-1" title="1"><span class="kw">require</span>(lattice)</a></code></pre></div>
<pre><code>## Loading required package: lattice</code></pre>
<div class="sourceCode" id="cb565"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb565-1" title="1"><span class="kw">xyplot</span>(peso <span class="op">~</span><span class="st"> </span>promalin, </a>
<a class="sourceLine" id="cb565-2" title="2">        <span class="dt">groups =</span> bloco, </a>
<a class="sourceLine" id="cb565-3" title="3">        <span class="dt">data=</span> dados)</a></code></pre></div>
<p><img src="TudodoR_files/figure-html/unnamed-chunk-320-1.png" width="672" /></p>
<p>O efeito do bloco é aditivo?</p>
<p>Ligar as observações com o mesmo bloco com a função <code>type ="o"</code>:</p>
<div class="sourceCode" id="cb566"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb566-1" title="1"><span class="kw">xyplot</span>(peso <span class="op">~</span><span class="st"> </span><span class="kw">reorder</span>(promalin, peso), </a>
<a class="sourceLine" id="cb566-2" title="2">        <span class="dt">groups =</span> bloco, </a>
<a class="sourceLine" id="cb566-3" title="3">        <span class="dt">data=</span> dados,</a>
<a class="sourceLine" id="cb566-4" title="4">        <span class="dt">type =</span> <span class="st">&quot;o&quot;</span>)</a></code></pre></div>
<p><img src="TudodoR_files/figure-html/unnamed-chunk-321-1.png" width="672" /></p>
<p>Reordenar os tratamentos:</p>
<div class="sourceCode" id="cb567"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb567-1" title="1"><span class="kw">require</span>(plyr)</a></code></pre></div>
<pre><code>## Loading required package: plyr</code></pre>
<div class="sourceCode" id="cb569"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb569-1" title="1">dados<span class="op">$</span>promalin &lt;-<span class="st"> </span><span class="kw">with</span>(dados, <span class="kw">reorder</span>(promalin, peso))</a>
<a class="sourceLine" id="cb569-2" title="2">dados &lt;-<span class="st"> </span><span class="kw">arrange</span>(dados, promalin, bloco)</a></code></pre></div>
<p>Gráficos reordenados de menor média a maior média por tratamento:</p>
<div class="sourceCode" id="cb570"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb570-1" title="1"><span class="kw">xyplot</span>(peso <span class="op">~</span><span class="st"> </span><span class="kw">reorder</span>(promalin, peso), </a>
<a class="sourceLine" id="cb570-2" title="2">        <span class="dt">groups =</span> bloco, </a>
<a class="sourceLine" id="cb570-3" title="3">        <span class="dt">data=</span> dados,</a>
<a class="sourceLine" id="cb570-4" title="4">        <span class="dt">type =</span> <span class="st">&quot;o&quot;</span>)</a></code></pre></div>
<p><img src="TudodoR_files/figure-html/unnamed-chunk-323-1.png" width="672" /></p>
<div id="análise-de-variância-1" class="section level4">
<h4><span class="header-section-number">8.2.1.1</span> Análise de variância</h4>
<p>Fazendo a análise de variância:</p>
<div class="sourceCode" id="cb571"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb571-1" title="1">m0 &lt;-<span class="st"> </span><span class="kw">lm</span> (dados<span class="op">$</span>peso <span class="op">~</span><span class="st"> </span>dados<span class="op">$</span>bloco <span class="op">+</span><span class="st"> </span>dados<span class="op">$</span>promalin, <span class="dt">data =</span> dados)</a></code></pre></div>
<div class="sourceCode" id="cb572"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb572-1" title="1"><span class="kw">anova</span>(m0)</a></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: dados$peso
##                Df Sum Sq Mean Sq F value   Pr(&gt;F)   
## dados$bloco     1  71.57  71.572  2.4574 0.139291   
## dados$promalin  4 788.95 197.238  6.7721 0.002994 **
## Residuals      14 407.75  29.125                    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Extraíndo o coeficiente de variação:</p>
<div class="sourceCode" id="cb574"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb574-1" title="1"><span class="kw">require</span>(agricolae)</a>
<a class="sourceLine" id="cb574-2" title="2"><span class="kw">cv.model</span>(m0)</a></code></pre></div>
<pre><code>## [1] 3.774477</code></pre>
<p>Análise gráfica dos resíduos:</p>
<div class="sourceCode" id="cb576"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb576-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow=</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb576-2" title="2"><span class="kw">plot</span>(m0)</a></code></pre></div>
<p><img src="TudodoR_files/figure-html/unnamed-chunk-327-1.png" width="672" /></p>
<p>Analisando a figura acima sugere que o principal problema deste conjunto de dados pode ser a não normalidade.</p>
<div id="teste-das-pressuposições-da-análise-de-variância" class="section level5">
<h5><span class="header-section-number">8.2.1.1.1</span> Teste das pressuposições da análise de variância</h5>
<div id="teste-de-bartllet-para-homocedasticidade" class="section level7">
<p><span class="header-section-number">8.2.1.1.1.0.1</span> Teste de Bartllet para homocedasticidade:</p>
<div class="sourceCode" id="cb577"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb577-1" title="1"><span class="kw">bartlett.test</span>(m0<span class="op">$</span>res, dados<span class="op">$</span>promalin)</a></code></pre></div>
<pre><code>## 
##  Bartlett test of homogeneity of variances
## 
## data:  m0$res and dados$promalin
## Bartlett&#39;s K-squared = 1.7485, df = 4, p-value = 0.7819</code></pre>
<p>Como observamos uma não significância estatística neste resultado <em>(p-value = 0.7819)</em>, devemos aceitar a hipótese nula de que as variâncias sejam as mesma em todos os níveis do fator.</p>
</div>
<div id="teste-de-shapiro-wilk-para-normalidade" class="section level7">
<p><span class="header-section-number">8.2.1.1.1.0.2</span> Teste de Shapiro-Wilk para Normalidade:</p>
<div class="sourceCode" id="cb579"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb579-1" title="1"><span class="kw">shapiro.test</span>(m0<span class="op">$</span>res)</a></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  m0$res
## W = 0.855, p-value = 0.006472</code></pre>
<p>Como observamos uma significância estatística neste resultado <em>(p-value = 0.006472)</em>, devemos rejeitar a hipótese nula de que os resíduos tedem a distruibuição normal.</p>
</div>
</div>
</div>
<div id="transformação-de-dados-1" class="section level4">
<h4><span class="header-section-number">8.2.1.2</span> Transformação de dados</h4>
<p>Tranformação de dados é uma das possíveis formas de contornar o problema de dados que não obedecem os pressupostos da análise de variância. Vamos ver como isto poder ser feito com o programa R.</p>
<div id="transformação-de-dados-com-o-box-cox" class="section level5">
<h5><span class="header-section-number">8.2.1.2.1</span> Transformação de dados com o BOX-COX</h5>
<p>Para tentar contornar o problema vamos usar a transformação Box-Cox, que consiste em transformar os dados de acordo com uma expressão.</p>
<p>A função <code>boxcox()</code> do pacote MASS calcula a verossimilhança perfilhada do parâmetro lambda. Devemos escolher o valor que maximiza esta função. Nos comandos a seguir começamos carregando o pacote MASS e depois obtemos o gráfico da verossimilhança perfilhada. Como estamos interessados no máximo, vamos fazer um novo gráfico com um zoom na região de interesse:</p>
<div class="sourceCode" id="cb581"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb581-1" title="1"><span class="kw">require</span>(MASS) </a>
<a class="sourceLine" id="cb581-2" title="2">  <span class="kw">boxcox</span>(m0)</a></code></pre></div>
<p><img src="TudodoR_files/figure-html/unnamed-chunk-330-1.png" width="672" /></p>
<div class="sourceCode" id="cb582"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb582-1" title="1">  <span class="kw">boxcox</span>(m0, <span class="dt">lam =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">8</span>, <span class="dv">8</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">10</span>))</a></code></pre></div>
<p><img src="TudodoR_files/figure-html/unnamed-chunk-330-2.png" width="672" /></p>
<p>Localizando o ponto máximo:</p>
</div>
<div id="análise-de-variância---ajuste-com-a-variável-transformada.-1" class="section level5">
<h5><span class="header-section-number">8.2.1.2.2</span> Análise de variância - Ajuste com a variável transformada.</h5>
<div class="sourceCode" id="cb583"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb583-1" title="1">m1 &lt;-<span class="st"> </span><span class="kw">aov</span> (<span class="kw">log</span>(dados<span class="op">$</span>peso) <span class="op">~</span><span class="st"> </span>dados<span class="op">$</span>promalin, <span class="dt">data =</span> dados)</a></code></pre></div>
<p>Anáise gráfica dos resíduos:</p>
<div class="sourceCode" id="cb584"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb584-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb584-2" title="2"><span class="kw">plot</span>(m1)</a></code></pre></div>
<p><img src="TudodoR_files/figure-html/unnamed-chunk-333-1.png" width="672" /></p>
<p>Os pressupostos foram atendindos?</p>
<p>Teste de Shapiro-Wilk para Normalidade:</p>
<div class="sourceCode" id="cb585"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb585-1" title="1"><span class="kw">shapiro.test</span>(m1<span class="op">$</span>res)</a></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  m1$res
## W = 0.93909, p-value = 0.2305</code></pre>
<p>Teste de Bartllet para homocedasticidade:</p>
<div class="sourceCode" id="cb587"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb587-1" title="1"><span class="kw">bartlett.test</span>(m1<span class="op">$</span>res, dados<span class="op">$</span>promalin)</a></code></pre></div>
<pre><code>## 
##  Bartlett test of homogeneity of variances
## 
## data:  m1$res and dados$promalin
## Bartlett&#39;s K-squared = 2.1761, df = 4, p-value = 0.7034</code></pre>
<div class="sourceCode" id="cb589"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb589-1" title="1"><span class="kw">anova</span>(m1)</a></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: log(dados$peso)
##                Df   Sum Sq   Mean Sq F value   Pr(&gt;F)   
## dados$promalin  4 0.036571 0.0091428  6.0129 0.004296 **
## Residuals      15 0.022808 0.0015205                    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
</div>
</div>
<div id="pacote-para-analise-de-experimentos" class="section level3">
<h3><span class="header-section-number">8.2.2</span> Pacote para analise de experimentos</h3>
<div class="sourceCode" id="cb591"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb591-1" title="1"><span class="kw">library</span>(ExpDes.pt)</a></code></pre></div>
<p>Conhecer o pacote ExpDes.pt:</p>
<div class="sourceCode" id="cb592"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb592-1" title="1"><span class="kw">ls</span>(<span class="st">&quot;package:ExpDes.pt&quot;</span>)</a></code></pre></div>
<pre><code>##  [1] &quot;anscombetukey&quot;  &quot;bartlett&quot;       &quot;ccboot&quot;         &quot;ccf&quot;           
##  [5] &quot;dbc&quot;            &quot;dic&quot;            &quot;dql&quot;            &quot;duncan&quot;        
##  [9] &quot;faixas&quot;         &quot;fat2.ad.dbc&quot;    &quot;fat2.ad.dic&quot;    &quot;fat2.dbc&quot;      
## [13] &quot;fat2.dic&quot;       &quot;fat3.ad.dbc&quot;    &quot;fat3.ad.dic&quot;    &quot;fat3.dbc&quot;      
## [17] &quot;fat3.dic&quot;       &quot;ginv&quot;           &quot;graficos&quot;       &quot;han&quot;           
## [21] &quot;lastC&quot;          &quot;layard&quot;         &quot;levene&quot;         &quot;lsd&quot;           
## [25] &quot;lsdb&quot;           &quot;oneilldbc&quot;      &quot;oneillmathews&quot;  &quot;order.group&quot;   
## [29] &quot;order.stat.SNK&quot; &quot;plotres&quot;        &quot;psub2.dbc&quot;      &quot;psub2.dic&quot;     
## [33] &quot;reg.nl&quot;         &quot;reg.poly&quot;       &quot;samiuddin&quot;      &quot;scottknott&quot;    
## [37] &quot;snk&quot;            &quot;tapply.stat&quot;    &quot;tukey&quot;</code></pre>
<p>Utilizando o exemplo anterior:</p>
<div class="sourceCode" id="cb594"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb594-1" title="1">x &lt;-<span class="st"> </span><span class="kw">dbc</span>(<span class="dt">trat =</span> dados<span class="op">$</span>promalin,</a>
<a class="sourceLine" id="cb594-2" title="2">          <span class="dt">bloco =</span> dados<span class="op">$</span>bloco,</a>
<a class="sourceLine" id="cb594-3" title="3">          <span class="dt">resp =</span> <span class="kw">log</span>(dados<span class="op">$</span>peso),</a>
<a class="sourceLine" id="cb594-4" title="4">          <span class="dt">quali =</span> T,</a>
<a class="sourceLine" id="cb594-5" title="5">          <span class="dt">mcomp =</span> <span class="st">&quot;tukey&quot;</span>)</a></code></pre></div>
<pre><code>## ------------------------------------------------------------------------
## Quadro da analise de variancia
## ------------------------------------------------------------------------
##            GL       SQ        QM     Fc   Pr&gt;Fc
## Tratamento  4 0.036571 0.0091428 5.7552 0.00800
## Bloco       3 0.003745 0.0012483 0.7858 0.52459
## Residuo    12 0.019063 0.0015886               
## Total      19 0.059379                         
## ------------------------------------------------------------------------
## CV = 0.8 %
## 
## ------------------------------------------------------------------------
## Teste de normalidade dos residuos 
## valor-p:  0.005994506 
## ATENCAO: a 5% de significancia, os residuos nao podem ser considerados normais!
## ------------------------------------------------------------------------
## 
## ------------------------------------------------------------------------
## Teste de homogeneidade de variancia 
## valor-p:  0.8927087 
## De acordo com o teste de oneillmathews a 5% de significancia, as variancias podem ser consideradas homogeneas.
## ------------------------------------------------------------------------
## 
## Teste de Tukey
## ------------------------------------------------------------------------
## Grupos Tratamentos Medias
## a     Testemunha      5.043544 
## ab    12.5    4.961465 
##  b    12.5+12.5   4.940843 
##  b    50.0    4.932278 
##  b    25.0    4.927864 
## ------------------------------------------------------------------------</code></pre>
<p>Carregar pacotes:</p>
<div class="sourceCode" id="cb596"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb596-1" title="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb596-2" title="2"><span class="kw">library</span>(dplyr)</a></code></pre></div>
<pre><code>## 
## Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:plyr&#39;:
## 
##     arrange, count, desc, failwith, id, mutate, rename, summarise,
##     summarize</code></pre>
<pre><code>## The following object is masked from &#39;package:MASS&#39;:
## 
##     select</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union</code></pre>
<p>Cálculo do erro:</p>
<div class="sourceCode" id="cb602"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb602-1" title="1">erro =<span class="st"> </span><span class="kw">summarise</span>(<span class="kw">group_by</span>(dados, promalin), </a>
<a class="sourceLine" id="cb602-2" title="2">       <span class="dt">avg =</span> <span class="kw">mean</span>(peso), <span class="dt">sd =</span> <span class="kw">sd</span>(peso))</a></code></pre></div>
<p>Gerando o gráfico:</p>
<div class="sourceCode" id="cb603"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb603-1" title="1"><span class="kw">ggplot</span>(erro, <span class="kw">aes</span>(promalin, avg, <span class="dt">fill=</span>promalin))<span class="op">+</span></a>
<a class="sourceLine" id="cb603-2" title="2"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb603-3" title="3"><span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>avg<span class="op">-</span>sd, <span class="dt">ymax =</span>avg<span class="op">+</span>sd), <span class="dt">with=</span><span class="fl">0.1</span>, <span class="dt">col=</span><span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb603-4" title="4"><span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;Tratamentos&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb603-5" title="5"><span class="st">    </span><span class="kw">ylab</span>(<span class="st">&quot;Peso médio dos frutos (g)&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb603-6" title="6"><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb603-7" title="7"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;top&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb603-8" title="8"><span class="st">      </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">label=</span><span class="st">&quot;ab&quot;</span>, <span class="dt">x=</span><span class="dv">1</span>, <span class="dt">y=</span><span class="dv">100</span>, <span class="dt">size =</span> <span class="dv">5</span>)  <span class="op">+</span></a>
<a class="sourceLine" id="cb603-9" title="9"><span class="st">      </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">label=</span><span class="st">&quot;b&quot;</span>, <span class="dt">x=</span><span class="dv">2</span>, <span class="dt">y=</span><span class="dv">100</span>, <span class="dt">size =</span> <span class="dv">5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb603-10" title="10"><span class="st">      </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">label=</span><span class="st">&quot;b&quot;</span>, <span class="dt">x=</span><span class="dv">3</span>, <span class="dt">y=</span><span class="dv">100</span>, <span class="dt">size =</span> <span class="dv">5</span>)  <span class="op">+</span></a>
<a class="sourceLine" id="cb603-11" title="11"><span class="st">      </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">label=</span><span class="st">&quot;b&quot;</span>, <span class="dt">x=</span><span class="dv">4</span>, <span class="dt">y=</span><span class="dv">100</span>, <span class="dt">size =</span> <span class="dv">5</span>)  <span class="op">+</span></a>
<a class="sourceLine" id="cb603-12" title="12"><span class="st">      </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">label=</span><span class="st">&quot;a&quot;</span>, <span class="dt">x=</span><span class="dv">5</span>, <span class="dt">y=</span><span class="dv">100</span>, <span class="dt">size =</span> <span class="dv">5</span>)  <span class="op">+</span></a>
<a class="sourceLine" id="cb603-13" title="13"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb603-14" title="14"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">caption =</span> <span class="st">&quot;Médias seguidas de mesma letra indicam diferença nula à 5%&quot;</span>)</a></code></pre></div>
<pre><code>## Warning: Ignoring unknown parameters: with</code></pre>
<p><img src="TudodoR_files/figure-html/unnamed-chunk-342-1.png" width="672" /></p>
</div>
<div id="teste-não-parametrico" class="section level3">
<h3><span class="header-section-number">8.2.3</span> Teste não parametrico</h3>
<p>As funções para comparações multiplas não-paramétricas incluídas no pacote agricolae são: <strong>kruskal</strong>, <strong>waerden.test</strong>, <strong>friedman</strong>, <strong>durbin.test</strong> e <strong>Conover (1999)</strong>.
Os testes não-paramétricos post hoc (kruskal, friedman, durbin e waerden) estão usando o critério da diferença menos significativa de Fisher (LSD).</p>
<p>Carregar pacote:</p>
<div class="sourceCode" id="cb605"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb605-1" title="1"><span class="kw">library</span>(agricolae)</a></code></pre></div>
<p>A função <code>kruskal</code> é usada para N amostras (N&gt; 2), populações ou dados provenientes de um experimento aleatório (populações = tratamentos):</p>
<div class="sourceCode" id="cb606"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb606-1" title="1">woutKruskal&lt;-<span class="kw">with</span>(dados,<span class="kw">kruskal</span>(promalin, <span class="dt">y =</span> peso</a>
<a class="sourceLine" id="cb606-2" title="2">  ,<span class="dt">p.adj=</span><span class="st">&quot;bon&quot;</span>,<span class="dt">group=</span>T, <span class="dt">console=</span>T))</a></code></pre></div>
<pre><code>## 
## Study: peso ~ promalin
## Kruskal-Wallis test&#39;s
## Ties or no Ties
## 
## Critical Value: 10.41429
## Degrees of freedom: 4
## Pvalue Chisq  : 0.03399839 
## 
## promalin,  means of the ranks
## 
##             peso r
## 12.5       12.00 4
## 12.5+12.5   7.75 4
## 25.0        7.50 4
## 50.0        7.00 4
## Testemunha 18.25 4
## 
## Post Hoc Analysis
## 
## P value adjustment method: bonferroni
## t-Student: 3.286039
## Alpha    : 0.05
## Minimum Significant Difference: 10.40002 
## 
## Treatments with the same letter are not significantly different.
## 
##             peso groups
## Testemunha 18.25      a
## 12.5       12.00     ab
## 12.5+12.5   7.75      b
## 25.0        7.50      b
## 50.0        7.00      b</code></pre>
<div class="sourceCode" id="cb608"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb608-1" title="1"><span class="kw">print</span>(woutKruskal<span class="op">$</span>group)</a></code></pre></div>
<pre><code>##             peso groups
## Testemunha 18.25      a
## 12.5       12.00     ab
## 12.5+12.5   7.75      b
## 25.0        7.50      b
## 50.0        7.00      b</code></pre>
<p>Gráficos:</p>
<div class="sourceCode" id="cb610"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb610-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>),<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="dt">cex=</span><span class="fl">0.8</span>)</a>
<a class="sourceLine" id="cb610-2" title="2"><span class="kw">bar.group</span>(woutKruskal<span class="op">$</span>group,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">100</span>), <span class="dt">xlab =</span><span class="st">&quot;promalin&quot;</span>)</a>
<a class="sourceLine" id="cb610-3" title="3"><span class="kw">bar.group</span>(woutKruskal<span class="op">$</span>group,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">100</span>),<span class="dt">horiz =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb610-4" title="4"><span class="kw">plot</span>(woutKruskal)</a>
<a class="sourceLine" id="cb610-5" title="5"><span class="kw">plot</span>(woutKruskal,<span class="dt">variation=</span><span class="st">&quot;IQR&quot;</span>,<span class="dt">horiz =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="TudodoR_files/figure-html/unnamed-chunk-345-1.png" width="672" /></p>
<p>A função <code>friedman</code> é usada para análise de tratamentos do estudo randomizado
de bloco completo, onde a resposta não pode ser tratada através da análise de variância:</p>
<div class="sourceCode" id="cb611"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb611-1" title="1">woutfriedman &lt;-<span class="st"> </span>out&lt;-<span class="kw">with</span>(dados,<span class="kw">friedman</span>(bloco,promalin, peso,<span class="dt">alpha=</span><span class="fl">0.05</span>, <span class="dt">group=</span>T,</a>
<a class="sourceLine" id="cb611-2" title="2">  <span class="dt">console=</span><span class="ot">TRUE</span>))</a></code></pre></div>
<pre><code>## 
## Study: peso ~ bloco + promalin 
## 
## promalin,  Sum of the ranks
## 
##            peso r
## 12.5          8 4
## 12.5+12.5     8 4
## 25.0         10 4
## 50.0         14 4
## Testemunha   20 4
## 
## Friedman&#39;s Test
## ===============
## Adjusted for ties
## Critical Value: 10.4
## P.Value Chisq: 0.0342027
## F Value: 5.571429
## P.Value F: 0.009007502 
## 
## Post Hoc Analysis
## 
## Alpha: 0.05 ; DF Error: 12
## t-Student: 2.178813
## LSD: 6.656383 
## 
## Treatments with the same letter are not significantly different.
## 
##            Sum of ranks groups
## Testemunha           20      a
## 50.0                 14     ab
## 25.0                 10      b
## 12.5                  8      b
## 12.5+12.5             8      b</code></pre>
<p>Gráfico:</p>
<div class="sourceCode" id="cb613"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb613-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>),<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="dt">cex=</span><span class="fl">0.8</span>)</a>
<a class="sourceLine" id="cb613-2" title="2"><span class="kw">bar.group</span>(woutfriedman<span class="op">$</span>group,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">100</span>), <span class="dt">xlab =</span><span class="st">&quot;promalin&quot;</span>)</a>
<a class="sourceLine" id="cb613-3" title="3"><span class="kw">bar.group</span>(woutfriedman<span class="op">$</span>group,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">100</span>),<span class="dt">horiz =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb613-4" title="4"><span class="kw">plot</span>(woutfriedman)</a>
<a class="sourceLine" id="cb613-5" title="5"><span class="kw">plot</span>(woutfriedman,<span class="dt">variation=</span><span class="st">&quot;IQR&quot;</span>,<span class="dt">horiz =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="TudodoR_files/figure-html/unnamed-chunk-347-1.png" width="672" /></p>
</div>
<div id="exercicio-1" class="section level3">
<h3><span class="header-section-number">8.2.4</span> Exercicio 1</h3>
<p>Obtenha: Análise exploratória, Análise de variância, teste de comparação múltipla, e recomendações.</p>
<p>Comparação de métodos de Semeadura do Mamoeiro</p>
<p>Estudo realizado em Jaboticabal - SP por Ruiz (1977) que comparou métodos de semeadura no mamoeiro. O experimento foi instalado em delineamento de blocos casualizados, com 4 repetições, avaliando 3 métodos de semeadura. Foram avaliadas duas unidades experimentais por método em cada bloco.</p>
<p>Importando dados:</p>
<div class="sourceCode" id="cb614"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb614-1" title="1">dados &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;https://www.dropbox.com/s/40m95attfw2fdh2/BanzattoQd4.7.1.txt?dl=1&quot;</span>) </a></code></pre></div>
<p>Conferir se temos fatores para fazer a análise de variância:</p>
<div class="sourceCode" id="cb615"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb615-1" title="1"><span class="kw">str</span>(dados)</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    24 obs. of  3 variables:
##  $ bloco : Factor w/ 4 levels &quot;I&quot;,&quot;II&quot;,&quot;III&quot;,..: 1 1 2 2 3 3 4 4 1 1 ...
##  $ semead: Factor w/ 3 levels &quot;Direta no campo&quot;,..: 1 1 1 1 1 1 1 1 2 2 ...
##  $ altura: num  136.1 105.3 98.8 86.8 108.8 ...</code></pre>
<p>Gráficos:</p>
<div class="sourceCode" id="cb617"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb617-1" title="1"><span class="kw">addmargins</span>(<span class="kw">with</span>(dados,</a>
<a class="sourceLine" id="cb617-2" title="2">  <span class="kw">tapply</span>(<span class="dt">X =</span> altura,</a>
<a class="sourceLine" id="cb617-3" title="3">    <span class="dt">INDEX =</span> <span class="kw">list</span>(semead, bloco),</a>
<a class="sourceLine" id="cb617-4" title="4">    <span class="dt">FUN =</span> sum)))</a></code></pre></div>
<pre><code>##                     I    II   III    IV    Sum
## Direta no campo 241.4 185.6 218.5 162.9  808.4
## Recip. ao sol   157.7 120.7 129.0  80.1  487.5
## Recip. ripado   123.5 127.1 132.9 109.8  493.3
## Sum             522.6 433.4 480.4 352.8 1789.2</code></pre>
<div class="sourceCode" id="cb619"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb619-1" title="1"><span class="kw">xyplot</span>(altura <span class="op">~</span><span class="st"> </span>semead, <span class="dt">data =</span> dados,</a>
<a class="sourceLine" id="cb619-2" title="2">  <span class="dt">groups =</span> bloco, <span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;p&quot;</span>, <span class="st">&quot;a&quot;</span>),</a>
<a class="sourceLine" id="cb619-3" title="3">  <span class="dt">xlab =</span> <span class="st">&quot;Método de semeadura de mamoeiro&quot;</span>,</a>
<a class="sourceLine" id="cb619-4" title="4">  <span class="dt">ylab =</span> <span class="st">&quot;Altura média de planta de mamoeiro aos 147 DAS (cm)&quot;</span>,</a>
<a class="sourceLine" id="cb619-5" title="5">  <span class="dt">auto.key =</span> <span class="kw">list</span>(<span class="dt">title =</span> <span class="st">&quot;Bloco&quot;</span>, <span class="dt">cex.title =</span> <span class="dv">1</span>, <span class="dt">columns =</span> <span class="dv">2</span>))</a></code></pre></div>
<p><img src="TudodoR_files/figure-html/unnamed-chunk-351-1.png" width="672" /></p>
<p>Análise de Variância:</p>
<div class="sourceCode" id="cb620"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb620-1" title="1">m0 &lt;-<span class="st"> </span><span class="kw">aov</span>(altura<span class="op">~</span>bloco<span class="op">+</span>semead, <span class="dt">data=</span>dados)</a>
<a class="sourceLine" id="cb620-2" title="2"><span class="kw">class</span>(m0)</a></code></pre></div>
<pre><code>## [1] &quot;aov&quot; &quot;lm&quot;</code></pre>
<div class="sourceCode" id="cb622"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb622-1" title="1"><span class="kw">anova</span>(m0)</a></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: altura
##           Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## bloco      3 2648.2   882.7  7.2162  0.002219 ** 
## semead     2 8429.1  4214.6 34.4535 7.014e-07 ***
## Residuals 18 2201.9   122.3                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb624"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb624-1" title="1"><span class="kw">summary</span>(m0)</a></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## bloco        3   2648     883   7.216  0.00222 ** 
## semead       2   8429    4215  34.453 7.01e-07 ***
## Residuals   18   2202     122                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Checagem gráfica:</p>
<div class="sourceCode" id="cb626"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb626-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb626-2" title="2"><span class="kw">plot</span>(m0)</a></code></pre></div>
<p><img src="TudodoR_files/figure-html/unnamed-chunk-353-1.png" width="672" /></p>
<div class="sourceCode" id="cb627"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb627-1" title="1"><span class="kw">layout</span>(<span class="dv">1</span>)</a></code></pre></div>
<p>Teste das pressuposições de normalidade de homocedasticidade:</p>
<div class="sourceCode" id="cb628"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb628-1" title="1"><span class="kw">shapiro.test</span>(<span class="kw">residuals</span>(m0))</a></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  residuals(m0)
## W = 0.95197, p-value = 0.2988</code></pre>
<div class="sourceCode" id="cb630"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb630-1" title="1"><span class="kw">bartlett.test</span>(<span class="kw">residuals</span>(m0)<span class="op">~</span>dados<span class="op">$</span>semead)</a></code></pre></div>
<pre><code>## 
##  Bartlett test of homogeneity of variances
## 
## data:  residuals(m0) by dados$semead
## Bartlett&#39;s K-squared = 4.5219, df = 2, p-value = 0.1043</code></pre>
<p>Teste de médias</p>
<p><strong>Teste de Tukey</strong></p>
<div class="sourceCode" id="cb632"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb632-1" title="1"><span class="kw">require</span>(agricolae)</a></code></pre></div>
<div class="sourceCode" id="cb633"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb633-1" title="1">tu &lt;-<span class="st"> </span><span class="kw">with</span>(dados, <span class="kw">HSD.test</span>(altura, semead,</a>
<a class="sourceLine" id="cb633-2" title="2"><span class="dt">DFerror=</span><span class="kw">df.residual</span>(m0),</a>
<a class="sourceLine" id="cb633-3" title="3"><span class="dt">MSerror=</span><span class="kw">deviance</span>(m0)<span class="op">/</span><span class="kw">df.residual</span>(m0)))</a></code></pre></div>
<div class="sourceCode" id="cb634"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb634-1" title="1"><span class="kw">plot</span>(tu)</a></code></pre></div>
<p><img src="TudodoR_files/figure-html/unnamed-chunk-357-1.png" width="672" /></p>
<div class="sourceCode" id="cb635"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb635-1" title="1"><span class="kw">print</span>(tu)</a></code></pre></div>
<pre><code>## $statistics
##    MSerror Df  Mean       CV      MSD
##   122.3258 18 74.55 14.83581 14.11359
## 
## $parameters
##    test name.t ntr StudentizedRange alpha
##   Tukey semead   3         3.609304  0.05
## 
## $means
##                   altura       std r  Min   Max    Q25    Q50     Q75
## Direta no campo 101.0500 19.263956 8 70.5 136.1 91.000 102.05 109.025
## Recip. ao sol    60.9375 15.187489 8 36.3  79.8 53.175  63.25  69.650
## Recip. ripado    61.6625  9.544922 8 43.7  77.1 58.575  62.95  65.425
## 
## $comparison
## NULL
## 
## $groups
##                   altura groups
## Direta no campo 101.0500      a
## Recip. ripado    61.6625      b
## Recip. ao sol    60.9375      b
## 
## attr(,&quot;class&quot;)
## [1] &quot;group&quot;</code></pre>
<div class="sourceCode" id="cb637"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb637-1" title="1"><span class="kw">require</span>(dplyr)</a>
<a class="sourceLine" id="cb637-2" title="2"><span class="kw">require</span>(ggplot2)</a>
<a class="sourceLine" id="cb637-3" title="3">  erro =<span class="st"> </span><span class="kw">summarise</span>(<span class="kw">group_by</span>(dados, semead), </a>
<a class="sourceLine" id="cb637-4" title="4">    <span class="dt">avg =</span> <span class="kw">mean</span>(altura), <span class="dt">sd =</span> <span class="kw">sd</span>(altura))</a>
<a class="sourceLine" id="cb637-5" title="5"></a>
<a class="sourceLine" id="cb637-6" title="6">  </a>
<a class="sourceLine" id="cb637-7" title="7">  <span class="kw">ggplot</span>(erro, <span class="kw">aes</span>(semead, avg, <span class="dt">fill=</span>semead))<span class="op">+</span></a>
<a class="sourceLine" id="cb637-8" title="8"><span class="st">    </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb637-9" title="9"><span class="st">    </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>avg<span class="op">-</span>sd, <span class="dt">ymax =</span>avg<span class="op">+</span>sd), <span class="dt">with=</span><span class="fl">0.1</span>, <span class="dt">col=</span><span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb637-10" title="10"><span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;Tratamentos&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb637-11" title="11"><span class="st">    </span><span class="kw">ylab</span>(<span class="st">&quot;Altura média de planta de mamoeiro aos 147 DAS (cm)&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb637-12" title="12"><span class="st">    </span><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb637-13" title="13"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;top&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb637-14" title="14"><span class="st">    </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">label=</span>tu<span class="op">$</span>groups<span class="op">$</span>groups[<span class="dv">1</span>], <span class="dt">x=</span><span class="dv">1</span>, <span class="dt">y=</span><span class="dv">20</span>, <span class="dt">size =</span> <span class="dv">5</span>)  <span class="op">+</span></a>
<a class="sourceLine" id="cb637-15" title="15"><span class="st">    </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">label=</span>tu<span class="op">$</span>groups<span class="op">$</span>groups[<span class="dv">2</span>], <span class="dt">x=</span><span class="dv">2</span>, <span class="dt">y=</span><span class="dv">20</span>, <span class="dt">size =</span> <span class="dv">5</span>)  <span class="op">+</span></a>
<a class="sourceLine" id="cb637-16" title="16"><span class="st">    </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">label=</span>tu<span class="op">$</span>groups<span class="op">$</span>groups[<span class="dv">3</span>], <span class="dt">x=</span><span class="dv">3</span>, <span class="dt">y=</span><span class="dv">20</span>, <span class="dt">size =</span> <span class="dv">5</span>)  <span class="op">+</span></a>
<a class="sourceLine" id="cb637-17" title="17"><span class="st">    </span></a>
<a class="sourceLine" id="cb637-18" title="18"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb637-19" title="19"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">caption =</span> <span class="st">&quot;Médias seguidas de mesma letra indicam diferença nula à 5%&quot;</span>)</a></code></pre></div>
<pre><code>## Warning: Ignoring unknown parameters: with</code></pre>
<p><img src="TudodoR_files/figure-html/unnamed-chunk-359-1.png" width="672" /></p>
<p><strong>Teste de Scott-Knott</strong></p>
<div class="sourceCode" id="cb639"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb639-1" title="1">  <span class="kw">library</span>(ScottKnott)</a>
<a class="sourceLine" id="cb639-2" title="2">  sk &lt;-<span class="st"> </span><span class="kw">SK</span>(<span class="dt">x=</span>dados, <span class="dt">y=</span>dados<span class="op">$</span>altura, <span class="dt">model=</span><span class="st">&quot;altura~bloco+semead&quot;</span>, <span class="dt">which=</span><span class="st">&quot;semead&quot;</span>)</a>
<a class="sourceLine" id="cb639-3" title="3">  <span class="kw">summary</span>(sk)</a></code></pre></div>
<pre><code>##           Levels    Means SK(5%)
##  Direta no campo 101.0500      a
##    Recip. ripado  61.6625      b
##    Recip. ao sol  60.9375      b</code></pre>
<div class="sourceCode" id="cb641"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb641-1" title="1"><span class="kw">print</span>(sk)</a></code></pre></div>
<pre><code>## $av
## Call:
##    aov(formula = altura ~ bloco + semead, data = dat)
## 
## Terms:
##                    bloco   semead Residuals
## Sum of Squares  2648.193 8429.103  2201.864
## Deg. of Freedom        3        2        18
## 
## Residual standard error: 11.0601
## Estimated effects may be unbalanced
## 
## $groups
## [1] 1 2 2
## 
## $nms
## [1] &quot;Direta no campo&quot; &quot;Recip. ao sol&quot;   &quot;Recip. ripado&quot;  
## 
## $ord
## [1] 1 3 2
## 
## $m.inf
##                     mean  min   max
## Direta no campo 101.0500 70.5 136.1
## Recip. ripado    61.6625 43.7  77.1
## Recip. ao sol    60.9375 36.3  79.8
## 
## $sig.level
## [1] 0.05
## 
## attr(,&quot;class&quot;)
## [1] &quot;SK&quot;   &quot;list&quot;</code></pre>
</div>
<div id="referência-5" class="section level3">
<h3><span class="header-section-number">8.2.5</span> Referência</h3>
<p>MELO, M. P.; PETERNELI, L. A. Conhecendo o R: Um visão mais que estatística. Viçosa, MG: UFV, 2013. 222p. Cap. 1.</p>
<p>BANZATTO, D. A; KRONKA, S. N. Experimentação agrícola. Jaboticabal, SP: FUNEP, 2006, 237p.</p>
<p>ZEVIANI, W. M. Estatística Básica e Experimentação no R. 45p.</p>
<p>Site: <a href="http://www.leg.ufpr.br/~paulojus/" class="uri">http://www.leg.ufpr.br/~paulojus/</a></p>

</div>
</div>
<div id="quadrado-latino" class="section level2">
<h2><span class="header-section-number">8.3</span> Quadrado Latino</h2>
<p>Esse material foi baseado nas aulas do <a href="https://www.youtube.com/user/walmes">Prof. Walmes Zeviani</a>.</p>
<div id="banco-de-dados" class="section level3">
<h3><span class="header-section-number">8.3.1</span> Banco de dados</h3>
<p>Iremos instalar o pacote com banco de dados.</p>
<p>O <a href="https://gitlab.c3sl.ufpr.br/pet-estatistica/labestData#descrio">labestData</a> é um pacote para o software R de computação estatística que possui centenas de conjuntos de dados para o ensino e aprendizado de estatística. O pacote é desenvolvido pelo PET Estatística UFPR e conta com a participação de professores e colaboradores. O nome
labest vem de LABoratório de ESTatística, que é o ambiente onde acontecem as aulas práticas do Curso de Estatística na UFPR.</p>
<div class="sourceCode" id="cb643"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb643-1" title="1"><span class="kw">library</span>(devtools)</a></code></pre></div>
<pre><code>## Loading required package: usethis</code></pre>
<p>Instalação do repositório de desenvolvimento no GitLab:</p>
<div class="sourceCode" id="cb645"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb645-1" title="1"><span class="kw">install_git</span>(<span class="dt">url =</span> <span class="st">&quot;https://gitlab.c3sl.ufpr.br/pet-estatistica/labestData.git&quot;</span>,</a>
<a class="sourceLine" id="cb645-2" title="2">            <span class="dt">branch =</span> <span class="st">&quot;master&quot;</span>, <span class="dt">build_vignettes =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p>Do repositório de divulgação no GitHub:</p>
<div class="sourceCode" id="cb646"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb646-1" title="1"><span class="kw">install_github</span>(<span class="dt">repo =</span> <span class="st">&quot;labestData&quot;</span>,</a>
<a class="sourceLine" id="cb646-2" title="2">               <span class="dt">username =</span> <span class="st">&quot;pet-estatistica&quot;</span>,</a>
<a class="sourceLine" id="cb646-3" title="3">               <span class="dt">ref =</span> <span class="st">&quot;master&quot;</span>, <span class="dt">build_vignettes =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p>Instalação por Arquivos Compactados:</p>
<div class="sourceCode" id="cb647"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb647-1" title="1"><span class="kw">install.packages</span>(<span class="st">&quot;http://leg.ufpr.br/~walmes/pacotes/labestData_0.1.17.458.zip&quot;</span>,</a>
<a class="sourceLine" id="cb647-2" title="2">  <span class="dt">repos =</span> <span class="ot">NULL</span>)</a></code></pre></div>
<p>Lendo arquivos de dados:</p>
<p>Escolhendo os dados:</p>
<div class="sourceCode" id="cb648"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb648-1" title="1"><span class="kw">labestDataView</span>()</a></code></pre></div>
<p>###Escolher o banco de dados</p>
<div class="sourceCode" id="cb649"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb649-1" title="1">PimentelEg6<span class="fl">.2</span></a></code></pre></div>
<pre><code>##    linha coluna varied prod
## 1      1      1      D  432
## 2      2      1      C  724
## 3      3      1      E  489
## 4      4      1      B  494
## 5      5      1      A  515
## 6      1      2      A  518
## 7      2      2      E  478
## 8      3      2      B  384
## 9      4      2      D  500
## 10     5      2      C  660
## 11     1      3      B  458
## 12     2      3      A  524
## 13     3      3      C  556
## 14     4      3      E  313
## 15     5      3      D  438
## 16     1      4      C  583
## 17     2      4      B  550
## 18     3      4      D  297
## 19     4      4      A  486
## 20     5      4      E  394
## 21     1      5      E  331
## 22     2      5      D  400
## 23     3      5      A  420
## 24     4      5      C  501
## 25     5      5      B  318</code></pre>
<div class="sourceCode" id="cb651"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb651-1" title="1"><span class="kw">help</span>(<span class="st">&quot;PimentelEg6.2&quot;</span>)</a></code></pre></div>
<p>Experimento de competição de variedades de cana-de-açúcar no qual foram usadas cinco variedades dispostas em um delineamento quadrado latino 5 times 5. Converte para nome de objeto mais simples:</p>
<div class="sourceCode" id="cb652"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb652-1" title="1">pim &lt;-<span class="st"> </span>PimentelEg6<span class="fl">.2</span> </a>
<a class="sourceLine" id="cb652-2" title="2"><span class="kw">help</span>(pim)</a></code></pre></div>
<pre><code>## No documentation for &#39;pim&#39; in specified packages and libraries:
## you could try &#39;??pim&#39;</code></pre>
<p>Verificar estrutura dos dados</p>
<div class="sourceCode" id="cb654"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb654-1" title="1"><span class="kw">str</span>(pim)</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    25 obs. of  4 variables:
##  $ linha : Factor w/ 5 levels &quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,..: 1 2 3 4 5 1 2 3 4 5 ...
##  $ coluna: Factor w/ 5 levels &quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,..: 1 1 1 1 1 2 2 2 2 2 ...
##  $ varied: Factor w/ 5 levels &quot;A&quot;,&quot;B&quot;,&quot;C&quot;,&quot;D&quot;,..: 4 3 5 2 1 1 5 2 4 3 ...
##  $ prod  : int  432 724 489 494 515 518 478 384 500 660 ...</code></pre>
<p>Vendo o quadrado no plano:</p>
<div class="sourceCode" id="cb656"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb656-1" title="1"><span class="kw">require</span>(reshape)</a></code></pre></div>
<pre><code>## Loading required package: reshape</code></pre>
<pre><code>## 
## Attaching package: &#39;reshape&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     rename</code></pre>
<pre><code>## The following objects are masked from &#39;package:plyr&#39;:
## 
##     rename, round_any</code></pre>
<p>Pacote gráfico:</p>
<div class="sourceCode" id="cb661"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb661-1" title="1"><span class="kw">require</span>(latticeExtra)</a></code></pre></div>
<pre><code>## Loading required package: latticeExtra</code></pre>
<pre><code>## 
## Attaching package: &#39;latticeExtra&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:ggplot2&#39;:
## 
##     layer</code></pre>
<p>Gerar gráfico:</p>
<div class="sourceCode" id="cb665"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb665-1" title="1"><span class="kw">levelplot</span>(prod<span class="op">~</span>linha<span class="op">+</span>coluna, <span class="dt">data=</span>pim, <span class="dt">aspect=</span><span class="st">&quot;iso&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb665-2" title="2"><span class="st">  </span><span class="kw">layer</span>(<span class="kw">with</span>(pim, <span class="kw">panel.text</span>(<span class="dt">x=</span>linha, <span class="dt">y=</span>coluna, <span class="dt">label=</span><span class="kw">paste</span>(varied, prod))))</a></code></pre></div>
<p><img src="TudodoR_files/figure-html/unnamed-chunk-374-1.png" width="672" /></p>
<p>ANOVA:</p>
<div class="sourceCode" id="cb666"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb666-1" title="1">m0 =<span class="st"> </span><span class="kw">lm</span> (prod <span class="op">~</span>linha <span class="op">+</span><span class="st"> </span>coluna <span class="op">+</span><span class="st"> </span>varied, <span class="dt">data =</span> pim)</a></code></pre></div>
<p>Pressuposto seja atendidos?</p>
<div class="sourceCode" id="cb667"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb667-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>)) </a>
<a class="sourceLine" id="cb667-2" title="2"><span class="kw">plot</span>(m0)</a></code></pre></div>
<p><img src="TudodoR_files/figure-html/unnamed-chunk-376-1.png" width="672" /></p>
<p>Teste de Bartllet para homocedasticidade:</p>
<div class="sourceCode" id="cb668"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb668-1" title="1"><span class="kw">bartlett.test</span>(m0<span class="op">$</span>residuals <span class="op">~</span><span class="st"> </span>pim<span class="op">$</span>varied)</a></code></pre></div>
<pre><code>## 
##  Bartlett test of homogeneity of variances
## 
## data:  m0$residuals by pim$varied
## Bartlett&#39;s K-squared = 5.6629, df = 4, p-value = 0.2258</code></pre>
<p>Teste de Shapiro-Wilk para Normalidade:</p>
<div class="sourceCode" id="cb670"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb670-1" title="1"><span class="kw">shapiro.test</span>(m0<span class="op">$</span>res)</a></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  m0$res
## W = 0.97701, p-value = 0.8202</code></pre>
<p>Quadro de análise de variância:</p>
<div class="sourceCode" id="cb672"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb672-1" title="1"><span class="kw">anova</span>(m0)</a></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: prod
##           Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## linha      4  30481    7620  2.6804 0.0831343 .  
## coluna     4  55641   13910  4.8930 0.0142293 *  
## varied     4 137488   34372 12.0905 0.0003585 ***
## Residuals 12  34115    2843                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb674"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb674-1" title="1"><span class="kw">summary</span>(m0)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = prod ~ linha + coluna + varied, data = pim)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -66.56 -25.16  -1.56  23.24  69.04 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   546.76      38.45  14.220 7.14e-09 ***
## linha2         70.80      33.72   2.100  0.05759 .  
## linha3        -35.20      33.72  -1.044  0.31713    
## linha4         -5.60      33.72  -0.166  0.87087    
## linha5          0.60      33.72   0.018  0.98610    
## coluna2       -22.80      33.72  -0.676  0.51178    
## coluna3       -73.00      33.72  -2.165  0.05127 .  
## coluna4       -68.80      33.72  -2.040  0.06397 .  
## coluna5      -136.80      33.72  -4.057  0.00159 ** 
## variedB       -51.80      33.72  -1.536  0.15045    
## variedC       112.20      33.72   3.327  0.00603 ** 
## variedD       -79.20      33.72  -2.349  0.03680 *  
## variedE       -91.60      33.72  -2.716  0.01873 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 53.32 on 12 degrees of freedom
## Multiple R-squared:  0.8676, Adjusted R-squared:  0.7353 
## F-statistic: 6.555 on 12 and 12 DF,  p-value: 0.001366</code></pre>
<p>Teste de média de comparações múltiplas:</p>
<div class="sourceCode" id="cb676"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb676-1" title="1"><span class="kw">library</span>(doBy) <span class="co"># obter as médias ajustadas </span></a>
<a class="sourceLine" id="cb676-2" title="2"><span class="kw">library</span>(multcomp)</a>
<a class="sourceLine" id="cb676-3" title="3">p0 =<span class="st"> </span><span class="kw">LSmeans</span>(m0, <span class="dt">effect =</span> <span class="st">&quot;varied&quot;</span>, <span class="dt">level =</span> <span class="fl">0.95</span>)</a></code></pre></div>
<p>Verificar estrutura:</p>
<div class="sourceCode" id="cb677"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb677-1" title="1"><span class="kw">str</span>(p0)</a></code></pre></div>
<pre><code>## List of 3
##  $ coef:&#39;data.frame&#39;:    5 obs. of  5 variables:
##   ..$ estimate : num [1:5] 493 441 605 413 401
##   ..$ std.error: num [1:5] 23.8 23.8 23.8 23.8 23.8
##   ..$ statistic: num [1:5] 20.7 18.5 25.4 17.3 16.8
##   ..$ df       : num [1:5] 12 12 12 12 12
##   ..$ p.value  : num [1:5] 9.55e-11 3.49e-10 8.57e-12 7.34e-10 1.04e-09
##  $ grid:&#39;data.frame&#39;:    5 obs. of  1 variable:
##   ..$ varied: chr [1:5] &quot;A&quot; &quot;B&quot; &quot;C&quot; &quot;D&quot; ...
##  $ L   : &#39;linest_matrix_class&#39; num [1:5, 1:13] 1 1 1 1 1 0.2 0.2 0.2 0.2 0.2 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : NULL
##   .. ..$ : chr [1:13] &quot;(Intercept)&quot; &quot;linha2&quot; &quot;linha3&quot; &quot;linha4&quot; ...
##   ..- attr(*, &quot;grid&quot;)=&#39;data.frame&#39;:  5 obs. of  1 variable:
##   .. ..$ varied: chr [1:5] &quot;A&quot; &quot;B&quot; &quot;C&quot; &quot;D&quot; ...
##  - attr(*, &quot;class&quot;)= chr &quot;linest_class&quot;</code></pre>
<div class="sourceCode" id="cb679"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb679-1" title="1">p0</a></code></pre></div>
<pre><code>## Coefficients:
##      estimate std.error statistic      df p.value
## [1,]  492.600    23.845    20.659  12.000       0
## [2,]  440.800    23.845    18.486  12.000       0
## [3,]  604.800    23.845    25.364  12.000       0
## [4,]  413.400    23.845    17.337  12.000       0
## [5,]  401.000    23.845    16.817  12.000       0</code></pre>
<div class="sourceCode" id="cb681"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb681-1" title="1"><span class="kw">library</span>(devtools) </a>
<a class="sourceLine" id="cb681-2" title="2"><span class="kw">install_github</span>(<span class="st">&quot;walmes/wzRfun&quot;</span>, <span class="dt">ref =</span> <span class="st">&quot;master&quot;</span>) </a></code></pre></div>
<pre><code>## Using github PAT from envvar GITHUB_PAT</code></pre>
<pre><code>## Skipping install of &#39;wzRfun&#39; from a github remote, the SHA1 (a90b379a) has not changed since last install.
##   Use `force = TRUE` to force installation</code></pre>
<div class="sourceCode" id="cb684"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb684-1" title="1"><span class="kw">require</span>(wzRfun)</a></code></pre></div>
<pre><code>## Loading required package: wzRfun</code></pre>
<pre><code>## ----------------------------------------------------------------------
##   wzRfun: Walmes Zeviani&#39;s collection of functions
## 
##   wzRfun (0.91, built on 2019-07-11) was loaded.
##   Consult online documentation at:
##     http://leg.ufpr.br/~walmes/pacotes/wzRfun
##   For collaboration, support or bug report, visit:
##     https://github.com/walmes/wzRfun/issues
##   For general information: packageDescription(&quot;wzRfun&quot;)
##   To access the package documentation: help(package = &quot;wzRfun&quot;)
## ----------------------------------------------------------------------</code></pre>
<p>Comparações múltiplas, contrastes de Tukey. Método de correção de p-valor: single-step</p>
<div class="sourceCode" id="cb687"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb687-1" title="1">tu &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">glht</span>(m0, <span class="dt">linfct=</span><span class="kw">mcp</span>(<span class="dt">varied=</span><span class="st">&quot;Tukey&quot;</span>))) </a>
<a class="sourceLine" id="cb687-2" title="2">tu</a></code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lm(formula = prod ~ linha + coluna + varied, data = pim)
## 
## Linear Hypotheses:
##            Estimate Std. Error t value Pr(&gt;|t|)    
## B - A == 0   -51.80      33.72  -1.536 0.560501    
## C - A == 0   112.20      33.72   3.327 0.039310 *  
## D - A == 0   -79.20      33.72  -2.349 0.195438    
## E - A == 0   -91.60      33.72  -2.716 0.109641    
## C - B == 0   164.00      33.72   4.863 0.002883 ** 
## D - B == 0   -27.40      33.72  -0.813 0.921778    
## E - B == 0   -39.80      33.72  -1.180 0.762083    
## D - C == 0  -191.40      33.72  -5.676 0.000791 ***
## E - C == 0  -203.80      33.72  -6.044 0.000477 ***
## E - D == 0   -12.40      33.72  -0.368 0.995553    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- single-step method)</code></pre>
<p>Resumo compacto com letras:</p>
<div class="sourceCode" id="cb689"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb689-1" title="1"><span class="kw">cld</span>(tu)</a></code></pre></div>
<pre><code>##   A   B   C   D   E 
## &quot;a&quot; &quot;a&quot; &quot;b&quot; &quot;a&quot; &quot;a&quot;</code></pre>
<div class="sourceCode" id="cb691"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb691-1" title="1"><span class="co">#cld(tu, decreasing=T)</span></a></code></pre></div>
<p>Médias com intervalo de confiança:</p>
<div class="sourceCode" id="cb692"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb692-1" title="1">ci &lt;-<span class="st"> </span><span class="kw">confint</span>(<span class="kw">glht</span>(m0, <span class="dt">linfct=</span> p0<span class="op">$</span>L)) </a>
<a class="sourceLine" id="cb692-2" title="2"><span class="kw">str</span>(ci)</a></code></pre></div>
<pre><code>## List of 9
##  $ model      :List of 13
##   ..$ coefficients : Named num [1:13] 546.8 70.8 -35.2 -5.6 0.6 ...
##   .. ..- attr(*, &quot;names&quot;)= chr [1:13] &quot;(Intercept)&quot; &quot;linha2&quot; &quot;linha3&quot; &quot;linha4&quot; ...
##   ..$ residuals    : Named num [1:25] -35.56 -5.76 69.04 4.64 -32.36 ...
##   .. ..- attr(*, &quot;names&quot;)= chr [1:25] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##   ..$ effects      : Named num [1:25] -2352.6 -161.7 64.937 10.772 -0.949 ...
##   .. ..- attr(*, &quot;names&quot;)= chr [1:25] &quot;(Intercept)&quot; &quot;linha2&quot; &quot;linha3&quot; &quot;linha4&quot; ...
##   ..$ rank         : int 13
##   ..$ fitted.values: Named num [1:25] 468 730 420 489 547 ...
##   .. ..- attr(*, &quot;names&quot;)= chr [1:25] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##   ..$ assign       : int [1:13] 0 1 1 1 1 2 2 2 2 3 ...
##   ..$ qr           :List of 5
##   .. ..$ qr   : num [1:25, 1:13] -5 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 ...
##   .. .. ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. .. .. ..$ : chr [1:25] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##   .. .. .. ..$ : chr [1:13] &quot;(Intercept)&quot; &quot;linha2&quot; &quot;linha3&quot; &quot;linha4&quot; ...
##   .. .. ..- attr(*, &quot;assign&quot;)= int [1:13] 0 1 1 1 1 2 2 2 2 3 ...
##   .. .. ..- attr(*, &quot;contrasts&quot;)=List of 3
##   .. .. .. ..$ linha : chr &quot;contr.treatment&quot;
##   .. .. .. ..$ coluna: chr &quot;contr.treatment&quot;
##   .. .. .. ..$ varied: chr &quot;contr.treatment&quot;
##   .. ..$ qraux: num [1:13] 1.2 1.42 1.41 1.4 1.38 ...
##   .. ..$ pivot: int [1:13] 1 2 3 4 5 6 7 8 9 10 ...
##   .. ..$ tol  : num 1e-07
##   .. ..$ rank : int 13
##   .. ..- attr(*, &quot;class&quot;)= chr &quot;qr&quot;
##   ..$ df.residual  : int 12
##   ..$ contrasts    :List of 3
##   .. ..$ linha : chr &quot;contr.treatment&quot;
##   .. ..$ coluna: chr &quot;contr.treatment&quot;
##   .. ..$ varied: chr &quot;contr.treatment&quot;
##   ..$ xlevels      :List of 3
##   .. ..$ linha : chr [1:5] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##   .. ..$ coluna: chr [1:5] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##   .. ..$ varied: chr [1:5] &quot;A&quot; &quot;B&quot; &quot;C&quot; &quot;D&quot; ...
##   ..$ call         : language lm(formula = prod ~ linha + coluna + varied, data = pim)
##   ..$ terms        :Classes &#39;terms&#39;, &#39;formula&#39;  language prod ~ linha + coluna + varied
##   .. .. ..- attr(*, &quot;variables&quot;)= language list(prod, linha, coluna, varied)
##   .. .. ..- attr(*, &quot;factors&quot;)= int [1:4, 1:3] 0 1 0 0 0 0 1 0 0 0 ...
##   .. .. .. ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. .. .. .. ..$ : chr [1:4] &quot;prod&quot; &quot;linha&quot; &quot;coluna&quot; &quot;varied&quot;
##   .. .. .. .. ..$ : chr [1:3] &quot;linha&quot; &quot;coluna&quot; &quot;varied&quot;
##   .. .. ..- attr(*, &quot;term.labels&quot;)= chr [1:3] &quot;linha&quot; &quot;coluna&quot; &quot;varied&quot;
##   .. .. ..- attr(*, &quot;order&quot;)= int [1:3] 1 1 1
##   .. .. ..- attr(*, &quot;intercept&quot;)= int 1
##   .. .. ..- attr(*, &quot;response&quot;)= int 1
##   .. .. ..- attr(*, &quot;.Environment&quot;)=&lt;environment: R_GlobalEnv&gt; 
##   .. .. ..- attr(*, &quot;predvars&quot;)= language list(prod, linha, coluna, varied)
##   .. .. ..- attr(*, &quot;dataClasses&quot;)= Named chr [1:4] &quot;numeric&quot; &quot;factor&quot; &quot;factor&quot; &quot;factor&quot;
##   .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:4] &quot;prod&quot; &quot;linha&quot; &quot;coluna&quot; &quot;varied&quot;
##   ..$ model        :&#39;data.frame&#39;:    25 obs. of  4 variables:
##   .. ..$ prod  : int [1:25] 432 724 489 494 515 518 478 384 500 660 ...
##   .. ..$ linha : Factor w/ 5 levels &quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,..: 1 2 3 4 5 1 2 3 4 5 ...
##   .. ..$ coluna: Factor w/ 5 levels &quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,..: 1 1 1 1 1 2 2 2 2 2 ...
##   .. ..$ varied: Factor w/ 5 levels &quot;A&quot;,&quot;B&quot;,&quot;C&quot;,&quot;D&quot;,..: 4 3 5 2 1 1 5 2 4 3 ...
##   .. ..- attr(*, &quot;terms&quot;)=Classes &#39;terms&#39;, &#39;formula&#39;  language prod ~ linha + coluna + varied
##   .. .. .. ..- attr(*, &quot;variables&quot;)= language list(prod, linha, coluna, varied)
##   .. .. .. ..- attr(*, &quot;factors&quot;)= int [1:4, 1:3] 0 1 0 0 0 0 1 0 0 0 ...
##   .. .. .. .. ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. .. .. .. .. ..$ : chr [1:4] &quot;prod&quot; &quot;linha&quot; &quot;coluna&quot; &quot;varied&quot;
##   .. .. .. .. .. ..$ : chr [1:3] &quot;linha&quot; &quot;coluna&quot; &quot;varied&quot;
##   .. .. .. ..- attr(*, &quot;term.labels&quot;)= chr [1:3] &quot;linha&quot; &quot;coluna&quot; &quot;varied&quot;
##   .. .. .. ..- attr(*, &quot;order&quot;)= int [1:3] 1 1 1
##   .. .. .. ..- attr(*, &quot;intercept&quot;)= int 1
##   .. .. .. ..- attr(*, &quot;response&quot;)= int 1
##   .. .. .. ..- attr(*, &quot;.Environment&quot;)=&lt;environment: R_GlobalEnv&gt; 
##   .. .. .. ..- attr(*, &quot;predvars&quot;)= language list(prod, linha, coluna, varied)
##   .. .. .. ..- attr(*, &quot;dataClasses&quot;)= Named chr [1:4] &quot;numeric&quot; &quot;factor&quot; &quot;factor&quot; &quot;factor&quot;
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:4] &quot;prod&quot; &quot;linha&quot; &quot;coluna&quot; &quot;varied&quot;
##   ..- attr(*, &quot;class&quot;)= chr &quot;lm&quot;
##  $ linfct     : &#39;linest_matrix_class&#39; num [1:5, 1:13] 1 1 1 1 1 0.2 0.2 0.2 0.2 0.2 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : chr [1:5] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##   .. ..$ : chr [1:13] &quot;(Intercept)&quot; &quot;linha2&quot; &quot;linha3&quot; &quot;linha4&quot; ...
##   ..- attr(*, &quot;grid&quot;)=&#39;data.frame&#39;:  5 obs. of  1 variable:
##   .. ..$ varied: chr [1:5] &quot;A&quot; &quot;B&quot; &quot;C&quot; &quot;D&quot; ...
##  $ rhs        : num [1:5] 0 0 0 0 0
##  $ coef       : Named num [1:13] 546.8 70.8 -35.2 -5.6 0.6 ...
##   ..- attr(*, &quot;names&quot;)= chr [1:13] &quot;(Intercept)&quot; &quot;linha2&quot; &quot;linha3&quot; &quot;linha4&quot; ...
##  $ vcov       : num [1:13, 1:13] 1478 -569 -569 -569 -569 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : chr [1:13] &quot;(Intercept)&quot; &quot;linha2&quot; &quot;linha3&quot; &quot;linha4&quot; ...
##   .. ..$ : chr [1:13] &quot;(Intercept)&quot; &quot;linha2&quot; &quot;linha3&quot; &quot;linha4&quot; ...
##  $ df         : int 12
##  $ alternative: chr &quot;two.sided&quot;
##  $ type       : NULL
##  $ confint    : num [1:5, 1:3] 493 441 605 413 401 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : chr [1:5] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##   .. ..$ : chr [1:3] &quot;Estimate&quot; &quot;lwr&quot; &quot;upr&quot;
##   ..- attr(*, &quot;conf.level&quot;)= num 0.95
##   ..- attr(*, &quot;calpha&quot;)= num 3
##  - attr(*, &quot;class&quot;)= chr [1:2] &quot;confint.glht&quot; &quot;glht&quot;
##  - attr(*, &quot;type&quot;)= chr &quot;adjusted&quot;</code></pre>
<p>Juntar com os nomes dos tratramentos com os intervalos:</p>
<div class="sourceCode" id="cb694"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb694-1" title="1">ci &lt;-<span class="st"> </span><span class="kw">cbind</span>(p0<span class="op">$</span>grid, ci<span class="op">$</span>confint)</a></code></pre></div>
<p>Colocar as letras. onde estão as letras?</p>
<div class="sourceCode" id="cb695"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb695-1" title="1"><span class="kw">str</span>(<span class="kw">cld</span>(tu))</a></code></pre></div>
<pre><code>## List of 10
##  $ y        : int [1:25] 432 724 489 494 515 518 478 384 500 660 ...
##  $ yname    : chr &quot;prod&quot;
##  $ x        : Factor w/ 5 levels &quot;A&quot;,&quot;B&quot;,&quot;C&quot;,&quot;D&quot;,..: 4 3 5 2 1 1 5 2 4 3 ...
##  $ xname    : chr &quot;varied&quot;
##  $ weights  : NULL
##  $ lp       : Named num [1:25] 468 730 420 489 547 ...
##   ..- attr(*, &quot;names&quot;)= chr [1:25] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##  $ covar    : logi TRUE
##  $ comps    : chr [1:10, 1:2] &quot;B&quot; &quot;C&quot; &quot;D&quot; &quot;E&quot; ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : chr [1:10] &quot;B - A&quot; &quot;C - A&quot; &quot;D - A&quot; &quot;E - A&quot; ...
##   .. ..$ : NULL
##  $ signif   : logi [1:10] FALSE TRUE FALSE FALSE TRUE FALSE ...
##  $ mcletters:List of 5
##   ..$ Letters          : Named chr [1:5] &quot;a&quot; &quot;a&quot; &quot;b&quot; &quot;a&quot; ...
##   .. ..- attr(*, &quot;names&quot;)= chr [1:5] &quot;A&quot; &quot;B&quot; &quot;C&quot; &quot;D&quot; ...
##   ..$ monospacedLetters: Named chr [1:5] &quot;a &quot; &quot;a &quot; &quot; b&quot; &quot;a &quot; ...
##   .. ..- attr(*, &quot;names&quot;)= chr [1:5] &quot;A&quot; &quot;B&quot; &quot;C&quot; &quot;D&quot; ...
##   ..$ LetterMatrix     : logi [1:5, 1:2] TRUE TRUE FALSE TRUE TRUE FALSE ...
##   .. ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. .. ..$ : chr [1:5] &quot;A&quot; &quot;B&quot; &quot;C&quot; &quot;D&quot; ...
##   .. .. ..$ : chr [1:2] &quot;a&quot; &quot;b&quot;
##   ..$ aLetters         : chr [1:52] &quot;a&quot; &quot;b&quot; &quot;c&quot; &quot;d&quot; ...
##   ..$ aseparator       : chr &quot;.&quot;
##   ..- attr(*, &quot;class&quot;)= chr &quot;multcompLetters&quot;
##  - attr(*, &quot;class&quot;)= chr &quot;cld&quot;</code></pre>
<div class="sourceCode" id="cb697"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb697-1" title="1">ci<span class="op">$</span>cld &lt;-<span class="st"> </span><span class="kw">cld</span>(tu)<span class="op">$</span>mcletters<span class="op">$</span>Letters </a>
<a class="sourceLine" id="cb697-2" title="2">ci<span class="op">$</span>cld</a></code></pre></div>
<pre><code>## [1] &quot;a&quot; &quot;a&quot; &quot;b&quot; &quot;a&quot; &quot;a&quot;</code></pre>
<div class="sourceCode" id="cb699"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb699-1" title="1"><span class="kw">str</span>(ci)</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    5 obs. of  5 variables:
##  $ varied  : chr  &quot;A&quot; &quot;B&quot; &quot;C&quot; &quot;D&quot; ...
##  $ Estimate: num  493 441 605 413 401
##  $ lwr     : num  421 369 533 342 329
##  $ upr     : num  564 512 676 485 473
##  $ cld     : chr  &quot;a&quot; &quot;a&quot; &quot;b&quot; &quot;a&quot; ...</code></pre>
<div class="sourceCode" id="cb701"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb701-1" title="1">ci<span class="op">$</span>varied &lt;-<span class="st"> </span><span class="kw">factor</span>(ci<span class="op">$</span>varied)</a></code></pre></div>
<p>Representação gráfica dos resultados:</p>
<div class="sourceCode" id="cb702"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb702-1" title="1"><span class="kw">require</span>(latticeExtra) </a>
<a class="sourceLine" id="cb702-2" title="2"><span class="kw">segplot</span>(varied<span class="op">~</span>lwr<span class="op">+</span>upr, </a>
<a class="sourceLine" id="cb702-3" title="3">        <span class="dt">centers=</span>Estimate, </a>
<a class="sourceLine" id="cb702-4" title="4">        <span class="dt">data=</span>ci, </a>
<a class="sourceLine" id="cb702-5" title="5">        <span class="dt">draw=</span>F, <span class="co">#desenhar segmentos </span></a>
<a class="sourceLine" id="cb702-6" title="6">        <span class="dt">xlab =</span> <span class="kw">expression</span>(<span class="st">&quot;Tratamento&quot;</span>), </a>
<a class="sourceLine" id="cb702-7" title="7">        <span class="dt">ylab =</span> <span class="st">&quot;Número de perfilhos&quot;</span>, </a>
<a class="sourceLine" id="cb702-8" title="8">        <span class="dt">sub =</span> <span class="kw">list</span>(<span class="st">&quot;Médias seguidas de mesma letra indicam diferença nula à 5%.&quot;</span>, </a>
<a class="sourceLine" id="cb702-9" title="9">                   <span class="dt">font=</span><span class="dv">1</span>, <span class="dt">cex=</span><span class="fl">0.8</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb702-10" title="10"><span class="kw">layer</span>(<span class="kw">panel.text</span>( <span class="dt">x =</span> centers, </a>
<a class="sourceLine" id="cb702-11" title="11">                 <span class="dt">y =</span> z, </a>
<a class="sourceLine" id="cb702-12" title="12">                 <span class="dt">labels =</span> <span class="kw">sprintf</span>(<span class="st">&quot;%0.2f %s&quot;</span>, centers, ci<span class="op">$</span>cld), </a>
<a class="sourceLine" id="cb702-13" title="13">                 <span class="dt">pos =</span> <span class="dv">3</span>))</a></code></pre></div>
<p><img src="TudodoR_files/figure-html/unnamed-chunk-388-1.png" width="672" /></p>
</div>
<div id="exercicios" class="section level3">
<h3><span class="header-section-number">8.3.2</span> Exercicios</h3>
<div class="sourceCode" id="cb703"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb703-1" title="1"><span class="kw">require</span>(labestData)</a>
<a class="sourceLine" id="cb703-2" title="2"></a>
<a class="sourceLine" id="cb703-3" title="3">ZimmermannTb5<span class="fl">.15</span></a></code></pre></div>
<pre><code>##    linha coluna trat perf
## 1      1      1    1  155
## 2      2      1    5  198
## 3      3      1    4  187
## 4      4      1    2  204
## 5      5      1    6  209
## 6      6      1    3  216
## 7      1      2    5  191
## 8      2      2    3  199
## 9      3      2    2  213
## 10     4      2    6  225
## 11     5      2    4  218
## 12     6      2    1  181
## 13     1      3    6  203
## 14     2      3    4  205
## 15     3      3    3  195
## 16     4      3    1  135
## 17     5      3    5  196
## 18     6      3    2  178
## 19     1      4    3  187
## 20     2      4    1  186
## 21     3      4    6  177
## 22     4      4    4  190
## 23     5      4    2  209
## 24     6      4    5  215
## 25     1      5    2  162
## 26     2      5    6  181
## 27     3      5    5  188
## 28     4      5    3  204
## 29     5      5    1  175
## 30     6      5    4  203
## 31     1      6    4  167
## 32     2      6    2  174
## 33     3      6    1  161
## 34     4      6    5  181
## 35     5      6    3  210
## 36     6      6    6  206</code></pre>
<div class="sourceCode" id="cb705"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb705-1" title="1"><span class="kw">help</span>(ZimmermannTb5<span class="fl">.15</span>) </a>
<a class="sourceLine" id="cb705-2" title="2"><span class="kw">str</span>(ZimmermannTb5<span class="fl">.15</span>)</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    36 obs. of  4 variables:
##  $ linha : Factor w/ 6 levels &quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,..: 1 2 3 4 5 6 1 2 3 4 ...
##  $ coluna: Factor w/ 6 levels &quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,..: 1 1 1 1 1 1 2 2 2 2 ...
##  $ trat  : Factor w/ 6 levels &quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,..: 1 5 4 2 6 3 5 3 2 6 ...
##  $ perf  : num  155 198 187 204 209 216 191 199 213 225 ...</code></pre>
<p>Atribuir um nome menor ao conjunto de dados:</p>
<div class="sourceCode" id="cb707"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb707-1" title="1">dados &lt;-<span class="st"> </span>ZimmermannTb5<span class="fl">.15</span></a></code></pre></div>
<p>Gráfico do layout:</p>
<div class="sourceCode" id="cb708"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb708-1" title="1"><span class="kw">require</span>(latticeExtra) </a>
<a class="sourceLine" id="cb708-2" title="2"></a>
<a class="sourceLine" id="cb708-3" title="3"><span class="kw">levelplot</span>(perf<span class="op">~</span>linha<span class="op">+</span>coluna, </a>
<a class="sourceLine" id="cb708-4" title="4">          <span class="dt">data=</span>dados, <span class="dt">aspect=</span><span class="st">&quot;iso&quot;</span>)<span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb708-5" title="5"><span class="st">          </span><span class="kw">layer</span>(<span class="kw">with</span>(dados, </a>
<a class="sourceLine" id="cb708-6" title="6">          <span class="kw">panel.text</span>(<span class="dt">x=</span>linha, <span class="dt">y=</span>coluna, </a>
<a class="sourceLine" id="cb708-7" title="7">          <span class="dt">label=</span><span class="kw">paste</span>(trat, perf))))</a></code></pre></div>
<p><img src="TudodoR_files/figure-html/unnamed-chunk-391-1.png" width="672" /></p>
<div class="sourceCode" id="cb709"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb709-1" title="1"><span class="kw">require</span>(latticeExtra)</a></code></pre></div>
<p>Gráfico do layout:</p>
<div class="sourceCode" id="cb710"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb710-1" title="1"><span class="kw">levelplot</span>(perf<span class="op">~</span>linha<span class="op">+</span>coluna, </a>
<a class="sourceLine" id="cb710-2" title="2">          <span class="dt">data=</span>dados, <span class="dt">aspect=</span><span class="st">&quot;iso&quot;</span>)<span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb710-3" title="3"><span class="st">          </span><span class="kw">layer</span>(<span class="kw">with</span>(dados, </a>
<a class="sourceLine" id="cb710-4" title="4">          <span class="kw">panel.text</span>(<span class="dt">x=</span>linha, <span class="dt">y=</span>coluna, </a>
<a class="sourceLine" id="cb710-5" title="5">          <span class="dt">label=</span><span class="kw">paste</span>(trat, perf))))</a></code></pre></div>
<p><img src="TudodoR_files/figure-html/unnamed-chunk-393-1.png" width="672" /></p>
<p>ANOVA:</p>
<div class="sourceCode" id="cb711"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb711-1" title="1">m0 =<span class="st"> </span><span class="kw">lm</span> (perf<span class="op">~</span>linha <span class="op">+</span><span class="st"> </span>coluna <span class="op">+</span><span class="st"> </span>trat, <span class="dt">data =</span> dados)</a></code></pre></div>
<p>Foram atendidos?</p>
<div class="sourceCode" id="cb712"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb712-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>)) </a>
<a class="sourceLine" id="cb712-2" title="2"><span class="kw">plot</span>(m0)</a></code></pre></div>
<p><img src="TudodoR_files/figure-html/unnamed-chunk-395-1.png" width="672" /></p>
<p>Teste de Bartllet para homocedasticidade:</p>
<div class="sourceCode" id="cb713"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb713-1" title="1"><span class="kw">bartlett.test</span>(m0<span class="op">$</span>res, dados<span class="op">$</span>trat)</a></code></pre></div>
<pre><code>## 
##  Bartlett test of homogeneity of variances
## 
## data:  m0$res and dados$trat
## Bartlett&#39;s K-squared = 6.5685, df = 5, p-value = 0.2548</code></pre>
<p>Teste de Shapiro-Wilk para Normalidade:</p>
<div class="sourceCode" id="cb715"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb715-1" title="1"><span class="kw">shapiro.test</span>(m0<span class="op">$</span>res)</a></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  m0$res
## W = 0.98701, p-value = 0.9408</code></pre>
<p>Quadro de análise de variância:</p>
<div class="sourceCode" id="cb717"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb717-1" title="1"><span class="kw">anova</span>(m0)</a></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: perf
##           Df Sum Sq Mean Sq F value  Pr(&gt;F)   
## linha      5 2513.9  502.78  2.5039 0.06461 . 
## coluna     5 1976.2  395.24  1.9684 0.12760   
## trat       5 5298.2 1059.64  5.2773 0.00299 **
## Residuals 20 4015.9  200.79                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb719"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb719-1" title="1"><span class="kw">summary</span>(m0)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = perf ~ linha + coluna + trat, data = dados)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -23.2222  -6.3889  -0.0556   5.9444  22.4444 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 155.3889     9.4468  16.449 4.34e-13 ***
## linha2       13.0000     8.1812   1.589 0.127741    
## linha3        9.3333     8.1812   1.141 0.267417    
## linha4       12.3333     8.1812   1.508 0.147310    
## linha5       25.3333     8.1812   3.097 0.005689 ** 
## linha6       22.3333     8.1812   2.730 0.012905 *  
## coluna2       9.6667     8.1812   1.182 0.251234    
## coluna3      -9.5000     8.1812  -1.161 0.259231    
## coluna4      -0.8333     8.1812  -0.102 0.919882    
## coluna5      -9.3333     8.1812  -1.141 0.267417    
## coluna6     -11.6667     8.1812  -1.426 0.169280    
## trat2        24.5000     8.1812   2.995 0.007161 ** 
## trat3        36.3333     8.1812   4.441 0.000251 ***
## trat4        29.5000     8.1812   3.606 0.001764 ** 
## trat5        29.3333     8.1812   3.585 0.001850 ** 
## trat6        34.6667     8.1812   4.237 0.000404 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 14.17 on 20 degrees of freedom
## Multiple R-squared:  0.7091, Adjusted R-squared:  0.4909 
## F-statistic:  3.25 on 15 and 20 DF,  p-value: 0.007591</code></pre>
<p>Comparações múltiplas:</p>
<div class="sourceCode" id="cb721"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb721-1" title="1"><span class="kw">library</span>(doBy) </a>
<a class="sourceLine" id="cb721-2" title="2"><span class="kw">library</span>(multcomp) </a>
<a class="sourceLine" id="cb721-3" title="3"></a>
<a class="sourceLine" id="cb721-4" title="4">p0 =<span class="st"> </span><span class="kw">LSmeans</span>(m0, <span class="dt">effect =</span> <span class="st">&quot;trat&quot;</span>, <span class="dt">level =</span> <span class="fl">0.95</span>) </a>
<a class="sourceLine" id="cb721-5" title="5"></a>
<a class="sourceLine" id="cb721-6" title="6"><span class="kw">str</span>(p0)</a></code></pre></div>
<pre><code>## List of 3
##  $ coef:&#39;data.frame&#39;:    6 obs. of  5 variables:
##   ..$ estimate : num [1:6] 165 190 202 195 195 ...
##   ..$ std.error: num [1:6] 5.78 5.78 5.78 5.78 5.78 ...
##   ..$ statistic: num [1:6] 28.6 32.8 34.9 33.7 33.7 ...
##   ..$ df       : num [1:6] 20 20 20 20 20 20
##   ..$ p.value  : num [1:6] 1.06e-17 7.10e-19 2.16e-19 4.26e-19 4.33e-19 ...
##  $ grid:&#39;data.frame&#39;:    6 obs. of  1 variable:
##   ..$ trat: chr [1:6] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##  $ L   : &#39;linest_matrix_class&#39; num [1:6, 1:16] 1 1 1 1 1 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : NULL
##   .. ..$ : chr [1:16] &quot;(Intercept)&quot; &quot;linha2&quot; &quot;linha3&quot; &quot;linha4&quot; ...
##   ..- attr(*, &quot;grid&quot;)=&#39;data.frame&#39;:  6 obs. of  1 variable:
##   .. ..$ trat: chr [1:6] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##  - attr(*, &quot;class&quot;)= chr &quot;linest_class&quot;</code></pre>
<p>Criando a tabela com as estimativas:</p>
<div class="sourceCode" id="cb723"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb723-1" title="1"><span class="kw">library</span>(devtools) </a>
<a class="sourceLine" id="cb723-2" title="2"><span class="co">#install_github(&quot;walmes/wzRfun&quot;, ref = &quot;master&quot;) </span></a>
<a class="sourceLine" id="cb723-3" title="3"><span class="kw">require</span>(wzRfun)</a></code></pre></div>
<p>Comparações múltiplas, contrastes de Tukey. Método de correção de p-valor: single-step.</p>
<div class="sourceCode" id="cb724"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb724-1" title="1">tu &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">glht</span>(m0, <span class="dt">linfct=</span><span class="kw">mcp</span>(<span class="dt">trat=</span><span class="st">&quot;Tukey&quot;</span>))) </a>
<a class="sourceLine" id="cb724-2" title="2">tu</a></code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lm(formula = perf ~ linha + coluna + trat, data = dados)
## 
## Linear Hypotheses:
##            Estimate Std. Error t value Pr(&gt;|t|)   
## 2 - 1 == 0  24.5000     8.1812   2.995  0.06751 . 
## 3 - 1 == 0  36.3333     8.1812   4.441  0.00295 **
## 4 - 1 == 0  29.5000     8.1812   3.606  0.01899 * 
## 5 - 1 == 0  29.3333     8.1812   3.585  0.01964 * 
## 6 - 1 == 0  34.6667     8.1812   4.237  0.00462 **
## 3 - 2 == 0  11.8333     8.1812   1.446  0.69976   
## 4 - 2 == 0   5.0000     8.1812   0.611  0.98894   
## 5 - 2 == 0   4.8333     8.1812   0.591  0.99051   
## 6 - 2 == 0  10.1667     8.1812   1.243  0.81104   
## 4 - 3 == 0  -6.8333     8.1812  -0.835  0.95719   
## 5 - 3 == 0  -7.0000     8.1812  -0.856  0.95272   
## 6 - 3 == 0  -1.6667     8.1812  -0.204  0.99994   
## 5 - 4 == 0  -0.1667     8.1812  -0.020  1.00000   
## 6 - 4 == 0   5.1667     8.1812   0.632  0.98718   
## 6 - 5 == 0   5.3333     8.1812   0.652  0.98524   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- single-step method)</code></pre>
<p>Resumo compacto com letras:</p>
<div class="sourceCode" id="cb726"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb726-1" title="1"><span class="kw">cld</span>(tu)</a></code></pre></div>
<pre><code>##    1    2    3    4    5    6 
##  &quot;a&quot; &quot;ab&quot;  &quot;b&quot;  &quot;b&quot;  &quot;b&quot;  &quot;b&quot;</code></pre>
<div class="sourceCode" id="cb728"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb728-1" title="1"><span class="co">#cld(tu, decreasing=T)</span></a></code></pre></div>
<p>Médias com intervalo de confiança:</p>
<div class="sourceCode" id="cb729"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb729-1" title="1">ci &lt;-<span class="st"> </span><span class="kw">confint</span>(<span class="kw">glht</span>(m0, <span class="dt">linfct=</span> p0<span class="op">$</span>L)) </a>
<a class="sourceLine" id="cb729-2" title="2">ci</a></code></pre></div>
<pre><code>## 
##   Simultaneous Confidence Intervals
## 
## Fit: lm(formula = perf ~ linha + coluna + trat, data = dados)
## 
## Quantile = 2.8976
## 95% family-wise confidence level
##  
## 
## Linear Hypotheses:
##        Estimate lwr      upr     
## 1 == 0 165.5000 148.7378 182.2622
## 2 == 0 190.0000 173.2378 206.7622
## 3 == 0 201.8333 185.0711 218.5956
## 4 == 0 195.0000 178.2378 211.7622
## 5 == 0 194.8333 178.0711 211.5956
## 6 == 0 200.1667 183.4044 216.9289</code></pre>
<p>Juntar com os nomes dos tratramentos com os intervalos:</p>
<div class="sourceCode" id="cb731"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb731-1" title="1">ci &lt;-<span class="st"> </span><span class="kw">cbind</span>(p0<span class="op">$</span>grid, ci<span class="op">$</span>confint) </a>
<a class="sourceLine" id="cb731-2" title="2"></a>
<a class="sourceLine" id="cb731-3" title="3">ci<span class="op">$</span>cld &lt;-<span class="st"> </span><span class="kw">cld</span>(tu)<span class="op">$</span>mcletters<span class="op">$</span>Letters </a>
<a class="sourceLine" id="cb731-4" title="4"></a>
<a class="sourceLine" id="cb731-5" title="5"><span class="kw">str</span>(<span class="kw">cld</span>(tu))</a></code></pre></div>
<pre><code>## List of 10
##  $ y        : num [1:36] 155 198 187 204 209 216 191 199 213 225 ...
##  $ yname    : chr &quot;perf&quot;
##  $ x        : Factor w/ 6 levels &quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,..: 1 5 4 2 6 3 5 3 2 6 ...
##  $ xname    : chr &quot;trat&quot;
##  $ weights  : NULL
##  $ lp       : Named num [1:36] 155 198 194 192 215 ...
##   ..- attr(*, &quot;names&quot;)= chr [1:36] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##  $ covar    : logi TRUE
##  $ comps    : chr [1:15, 1:2] &quot;2&quot; &quot;3&quot; &quot;4&quot; &quot;5&quot; ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : chr [1:15] &quot;2 - 1&quot; &quot;3 - 1&quot; &quot;4 - 1&quot; &quot;5 - 1&quot; ...
##   .. ..$ : NULL
##  $ signif   : logi [1:15] FALSE TRUE TRUE TRUE TRUE FALSE ...
##  $ mcletters:List of 5
##   ..$ Letters          : Named chr [1:6] &quot;a&quot; &quot;ab&quot; &quot;b&quot; &quot;b&quot; ...
##   .. ..- attr(*, &quot;names&quot;)= chr [1:6] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##   ..$ monospacedLetters: Named chr [1:6] &quot;a &quot; &quot;ab&quot; &quot; b&quot; &quot; b&quot; ...
##   .. ..- attr(*, &quot;names&quot;)= chr [1:6] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##   ..$ LetterMatrix     : logi [1:6, 1:2] TRUE TRUE FALSE FALSE FALSE FALSE ...
##   .. ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. .. ..$ : chr [1:6] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##   .. .. ..$ : chr [1:2] &quot;a&quot; &quot;b&quot;
##   ..$ aLetters         : chr [1:52] &quot;a&quot; &quot;b&quot; &quot;c&quot; &quot;d&quot; ...
##   ..$ aseparator       : chr &quot;.&quot;
##   ..- attr(*, &quot;class&quot;)= chr &quot;multcompLetters&quot;
##  - attr(*, &quot;class&quot;)= chr &quot;cld&quot;</code></pre>
<p>Representação gráfica dos resultados:</p>
<div class="sourceCode" id="cb733"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb733-1" title="1"><span class="kw">require</span>(latticeExtra) </a>
<a class="sourceLine" id="cb733-2" title="2"></a>
<a class="sourceLine" id="cb733-3" title="3"><span class="kw">segplot</span>(trat<span class="op">~</span>lwr<span class="op">+</span>upr, </a>
<a class="sourceLine" id="cb733-4" title="4">        <span class="dt">centers=</span>Estimate, </a>
<a class="sourceLine" id="cb733-5" title="5">        <span class="dt">data=</span>ci, </a>
<a class="sourceLine" id="cb733-6" title="6">        <span class="dt">draw=</span>F,</a>
<a class="sourceLine" id="cb733-7" title="7">        <span class="dt">xlab =</span> <span class="kw">expression</span>(<span class="st">&quot; &quot;</span>), <span class="dt">ylab =</span> <span class="st">&quot; &quot;</span>, </a>
<a class="sourceLine" id="cb733-8" title="8">        <span class="dt">sub =</span> <span class="kw">list</span>(<span class="st">&quot;Médias seguidas de mesma letra indicam diferença nula à 5%.&quot;</span>,</a>
<a class="sourceLine" id="cb733-9" title="9">        <span class="dt">font=</span><span class="dv">1</span>, <span class="dt">cex=</span><span class="fl">0.8</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb733-10" title="10"><span class="st">        </span><span class="kw">layer</span>(<span class="kw">panel.text</span>( <span class="dt">x =</span> centers, </a>
<a class="sourceLine" id="cb733-11" title="11">        <span class="dt">y =</span> z, </a>
<a class="sourceLine" id="cb733-12" title="12">        <span class="dt">labels =</span> <span class="kw">sprintf</span>(<span class="st">&quot;%0.2f %s&quot;</span>, centers, ci<span class="op">$</span>cld), </a>
<a class="sourceLine" id="cb733-13" title="13">        <span class="dt">pos =</span> <span class="dv">3</span>))</a></code></pre></div>
<p><img src="TudodoR_files/figure-html/unnamed-chunk-405-1.png" width="672" /></p>
</div>
<div id="exercicio-para-entregar" class="section level3">
<h3><span class="header-section-number">8.3.3</span> Exercicio para entregar</h3>
<p>DiasEg9.4
help(“DiasEg9.4”)</p>
<p>BarbinPg104
help(“BarbinPg104”)</p>
<p>ZimmermannTb12.27
help(ZimmermannTb12.27)</p>
<p>ZimmermannTb12.26
help(ZimmermannTb12.26)</p>
<p>StorckEg2.3.5
help(StorckEg2.3.5)</p>
<p>ZimmermannTb16.10
help(ZimmermannTb16.10)</p>

</div>
</div>
<div id="regressão-linear-simples" class="section level2">
<h2><span class="header-section-number">8.4</span> Regressão Linear simples</h2>
<p>Iremos utilizar o pacote tidyverse:</p>
<div class="sourceCode" id="cb734"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb734-1" title="1"><span class="kw">library</span>(tidyverse)</a></code></pre></div>
<pre><code>## -- Attaching packages ----------------------------------- tidyverse 1.3.0 --</code></pre>
<pre><code>## v tibble  3.0.1     v purrr   0.3.4
## v tidyr   1.0.2     v stringr 1.4.0
## v readr   1.3.1     v forcats 0.5.0</code></pre>
<pre><code>## -- Conflicts -------------------------------------- tidyverse_conflicts() --
## x dplyr::arrange()      masks plyr::arrange()
## x purrr::compact()      masks plyr::compact()
## x dplyr::count()        masks plyr::count()
## x tidyr::expand()       masks reshape::expand()
## x dplyr::failwith()     masks plyr::failwith()
## x dplyr::filter()       masks stats::filter()
## x dplyr::id()           masks plyr::id()
## x dplyr::lag()          masks stats::lag()
## x latticeExtra::layer() masks ggplot2::layer()
## x dplyr::mutate()       masks plyr::mutate()
## x reshape::rename()     masks dplyr::rename(), plyr::rename()
## x dplyr::select()       masks MASS::select()
## x dplyr::summarise()    masks plyr::summarise()
## x dplyr::summarize()    masks plyr::summarize()</code></pre>
<p>Regressão linear é uma equação para estimar a condicional (valor esperado) de
uma variável y, dados os valores de algumas outras variáveis x.</p>
<p>y= a+bx</p>
<p>Vamos utilizar o exemplo do banco de dados do R:</p>
<div class="sourceCode" id="cb738"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb738-1" title="1"><span class="kw">View</span>(Orange)</a></code></pre></div>
<div class="sourceCode" id="cb739"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb739-1" title="1"><span class="kw">qplot</span>(<span class="dt">x=</span>age,<span class="dt">y=</span>circumference,<span class="dt">data=</span>Orange)</a></code></pre></div>
<p><img src="TudodoR_files/figure-html/unnamed-chunk-408-1.png" width="672" /></p>
<div class="sourceCode" id="cb740"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb740-1" title="1"><span class="kw">cor.test</span>(Orange<span class="op">$</span>age,Orange<span class="op">$</span>circumference)</a></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  Orange$age and Orange$circumference
## t = 12.9, df = 33, p-value = 1.931e-14
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.8342364 0.9557955
## sample estimates:
##       cor 
## 0.9135189</code></pre>
<div class="sourceCode" id="cb742"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb742-1" title="1">rl&lt;-<span class="st"> </span><span class="kw">lm</span>(circumference <span class="op">~</span><span class="st"> </span>age , <span class="dt">data =</span> Orange)</a></code></pre></div>
<p>Zerando o intercepto</p>
<div class="sourceCode" id="cb743"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb743-1" title="1">rl0&lt;-<span class="st"> </span><span class="kw">lm</span>(circumference <span class="op">~</span><span class="st"> </span><span class="dv">0</span><span class="op">+</span><span class="st"> </span>age , <span class="dt">data =</span> Orange)</a></code></pre></div>
<div class="sourceCode" id="cb744"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb744-1" title="1"><span class="kw">plot</span>(rl) <span class="co">#plots diagnósticos</span></a></code></pre></div>
<p><img src="TudodoR_files/figure-html/unnamed-chunk-412-1.png" width="672" /><img src="TudodoR_files/figure-html/unnamed-chunk-412-2.png" width="672" /><img src="TudodoR_files/figure-html/unnamed-chunk-412-3.png" width="672" /><img src="TudodoR_files/figure-html/unnamed-chunk-412-4.png" width="672" /></p>
<div class="sourceCode" id="cb745"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb745-1" title="1"><span class="kw">shapiro.test</span> (<span class="kw">residuals</span>(rl))</a></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  residuals(rl)
## W = 0.97289, p-value = 0.5273</code></pre>
<div class="sourceCode" id="cb747"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb747-1" title="1"><span class="kw">bartlett.test</span>(rl<span class="op">$</span>res, Orange<span class="op">$</span>Tree, Orange<span class="op">$</span>age)</a></code></pre></div>
<pre><code>## 
##  Bartlett test of homogeneity of variances
## 
## data:  rl$res and Orange$Tree
## Bartlett&#39;s K-squared = 2.7663, df = 4, p-value = 0.5977</code></pre>
<p>Resultado da Regressãolinear:</p>
<div class="sourceCode" id="cb749"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb749-1" title="1"><span class="kw">summary</span>(rl)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = circumference ~ age, data = Orange)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -46.310 -14.946  -0.076  19.697  45.111 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 17.399650   8.622660   2.018   0.0518 .  
## age          0.106770   0.008277  12.900 1.93e-14 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 23.74 on 33 degrees of freedom
## Multiple R-squared:  0.8345, Adjusted R-squared:  0.8295 
## F-statistic: 166.4 on 1 and 33 DF,  p-value: 1.931e-14</code></pre>
<p>Rejeição da hipótese nula (variáveis não são relacionadas)
<em>valor p &lt;0.005</em>
R-square explica o quanto o modelo explica da variação</p>
<p>Gráfico:</p>
<div class="sourceCode" id="cb751"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb751-1" title="1"><span class="kw">ggplot</span>(Orange,<span class="kw">aes</span>(<span class="dt">x=</span>age,<span class="dt">y=</span>circumference))<span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">colour=</span><span class="st">&quot;steelblue&quot;</span>,<span class="dt">size=</span><span class="dv">4</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb751-2" title="2"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span><span class="st">&quot;lm&quot;</span>,<span class="dt">colour=</span><span class="st">&quot;black&quot;</span>)<span class="op">+</span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Regressão linear de Orange&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb751-3" title="3"><span class="st">  </span><span class="kw">theme_minimal</span>()  </a></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="TudodoR_files/figure-html/unnamed-chunk-415-1.png" width="672" /></p>
<p>Gerar gráficos com o pacote ggpmisc:</p>
<div class="sourceCode" id="cb753"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb753-1" title="1"><span class="kw">library</span>(ggpmisc)</a></code></pre></div>
<p>Gráfico:</p>
<div class="sourceCode" id="cb754"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb754-1" title="1">formula &lt;-<span class="st"> </span>y <span class="op">~</span><span class="st"> </span><span class="kw">poly</span>(x, <span class="dv">2</span>, <span class="dt">raw =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb754-2" title="2"><span class="kw">ggplot</span>(Orange, <span class="kw">aes</span>(<span class="dt">x=</span>age, <span class="dt">y=</span>circumference)) <span class="op">+</span></a>
<a class="sourceLine" id="cb754-3" title="3"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb754-4" title="4"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">formula =</span> formula) <span class="op">+</span></a>
<a class="sourceLine" id="cb754-5" title="5"><span class="st">  </span><span class="kw">stat_poly_eq</span>(<span class="kw">aes</span>(<span class="dt">label =</span>  <span class="kw">paste</span>(..eq.label.., ..adj.rr.label.., <span class="dt">sep =</span> <span class="st">&quot;~~~~&quot;</span>)),</a>
<a class="sourceLine" id="cb754-6" title="6">    <span class="dt">formula =</span> formula, <span class="dt">parse =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="TudodoR_files/figure-html/unnamed-chunk-417-1.png" width="672" /></p>
<p>Outras funções interessantes:</p>
<div class="sourceCode" id="cb755"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb755-1" title="1"><span class="kw">coefficients</span>(rl) <span class="co"># coeficientes do modelo</span></a></code></pre></div>
<pre><code>## (Intercept)         age 
##  17.3996502   0.1067703</code></pre>
<div class="sourceCode" id="cb757"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb757-1" title="1"><span class="kw">confint</span>(rl, <span class="dt">level=</span><span class="fl">0.95</span>) <span class="co"># intervalo de confiança</span></a></code></pre></div>
<pre><code>##                   2.5 %     97.5 %
## (Intercept) -0.14328303 34.9425835
## age          0.08993141  0.1236092</code></pre>
<div class="sourceCode" id="cb759"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb759-1" title="1"><span class="kw">fitted</span>(rl) <span class="co"># valores previstos</span></a></code></pre></div>
<pre><code>##         1         2         3         4         5         6         7         8 
##  29.99855  69.07649  88.29515 124.59706 148.83392 163.88854 186.31030  29.99855 
##         9        10        11        12        13        14        15        16 
##  69.07649  88.29515 124.59706 148.83392 163.88854 186.31030  29.99855  69.07649 
##        17        18        19        20        21        22        23        24 
##  88.29515 124.59706 148.83392 163.88854 186.31030  29.99855  69.07649  88.29515 
##        25        26        27        28        29        30        31        32 
## 124.59706 148.83392 163.88854 186.31030  29.99855  69.07649  88.29515 124.59706 
##        33        34        35 
## 148.83392 163.88854 186.31030</code></pre>
<div class="sourceCode" id="cb761"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb761-1" title="1"><span class="kw">residuals</span>(rl) <span class="co"># residuais</span></a></code></pre></div>
<pre><code>##             1             2             3             4             5 
##   0.001451402 -11.076487573  -1.295146086  -9.597056609 -28.833920400 
##             6             7             8             9            10 
## -21.888536235 -41.310304499   3.001451402  -0.076487573  22.704853914 
##            11            12            13            14            15 
##  31.402943391  23.166079600  39.111463765  16.689695501   0.001451402 
##            16            17            18            19            20 
## -18.076487573 -13.295146086 -16.597056609 -33.833920400 -24.888536235 
##            21            22            23            24            25 
## -46.310304499   2.001451402  -7.076487573  23.704853914  42.402943391 
##            26            27            28            29            30 
##  30.166079600  45.111463765  27.689695501   0.001451402 -20.076487573 
##            31            32            33            34            35 
##  -7.295146086   0.402943391  -6.833920400  10.111463765  -9.310304499</code></pre>
<div class="sourceCode" id="cb763"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb763-1" title="1"><span class="kw">anova</span>(rl) <span class="co"># tabela ANOVA</span></a></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: circumference
##           Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## age        1  93772   93772  166.42 1.931e-14 ***
## Residuals 33  18595     563                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Qualquer modelo de regressão polinomial pode ser obtido com um comando
simples: o <code>lm()</code> que vem do inglês “linear models”.</p>
<p>Veja o exemplo abaixo:</p>
<div class="sourceCode" id="cb765"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb765-1" title="1">fert&lt;-<span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">40</span>,<span class="dv">50</span>,<span class="dv">60</span>,<span class="dv">70</span>,<span class="dv">80</span>,<span class="dv">90</span>,<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb765-2" title="2">prod&lt;-<span class="kw">c</span>(<span class="dv">42</span>,<span class="dv">61</span>,<span class="dv">81</span>,<span class="dv">94</span>,<span class="dv">98</span>,<span class="dv">96</span>,<span class="dv">83</span>,<span class="dv">79</span>,<span class="dv">59</span>,<span class="dv">43</span>)</a>
<a class="sourceLine" id="cb765-3" title="3"><span class="kw">plot</span>(fert,prod)</a></code></pre></div>
<p><img src="TudodoR_files/figure-html/unnamed-chunk-419-1.png" width="672" /></p>
<div class="sourceCode" id="cb766"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb766-1" title="1">dados =<span class="st"> </span><span class="kw">data.frame</span>(fert,prod)</a></code></pre></div>
<p>Observe a necessidade do argumento <code>I()</code> para interações como x^2:</p>
<div class="sourceCode" id="cb767"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb767-1" title="1">reg &lt;-<span class="st"> </span><span class="kw">lm</span> ( <span class="co">#ajusta uma Regressão</span></a>
<a class="sourceLine" id="cb767-2" title="2">        prod <span class="op">~</span><span class="st"> </span>fert <span class="op">+</span><span class="st"> </span><span class="kw">I</span> (fert<span class="op">^</span><span class="dv">2</span>)) <span class="co">#modelo de Regressão quadrática</span></a>
<a class="sourceLine" id="cb767-3" title="3">reg</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = prod ~ fert + I(fert^2))
## 
## Coefficients:
## (Intercept)         fert    I(fert^2)  
##    15.51667      2.95720     -0.02716</code></pre>
<p>Para “desenhar” a curva ajustada:</p>
<div class="sourceCode" id="cb769"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb769-1" title="1"><span class="co">#curve(15.51667+2.95720*x-0.02716*x*x,0,100,add=T,col=2)</span></a></code></pre></div>
<p>Várias outras análises podem ser feitas como anteriormente na regressão linear. Veja uma delas:</p>
<div class="sourceCode" id="cb770"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb770-1" title="1"> <span class="kw">anova</span>(reg)</a></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: prod
##           Df Sum Sq Mean Sq  F value    Pr(&gt;F)    
## fert       1    7.6     7.6   0.5878    0.4683    
## I(fert^2)  1 3894.6  3894.6 302.2072 5.126e-07 ***
## Residuals  7   90.2    12.9                       
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb772"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb772-1" title="1"> formula &lt;-<span class="st"> </span>y <span class="op">~</span><span class="st"> </span><span class="kw">poly</span>(x, <span class="dv">2</span>, <span class="dt">raw =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb772-2" title="2"> <span class="kw">ggplot</span>(dados, <span class="kw">aes</span>(<span class="dt">x=</span>fert, <span class="dt">y=</span>prod)) <span class="op">+</span></a>
<a class="sourceLine" id="cb772-3" title="3"><span class="st">   </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb772-4" title="4"><span class="st">   </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">formula =</span> formula) <span class="op">+</span></a>
<a class="sourceLine" id="cb772-5" title="5"><span class="st">   </span><span class="kw">stat_poly_eq</span>(<span class="kw">aes</span>(<span class="dt">label =</span>  <span class="kw">paste</span>(..eq.label.., ..adj.rr.label.., </a>
<a class="sourceLine" id="cb772-6" title="6">     <span class="dt">sep =</span> <span class="st">&quot;~~italic(</span><span class="ch">\&quot;</span><span class="st">with</span><span class="ch">\&quot;</span><span class="st">)~~&quot;</span>)),</a>
<a class="sourceLine" id="cb772-7" title="7">     <span class="dt">formula =</span> formula, <span class="dt">parse =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="TudodoR_files/figure-html/unnamed-chunk-423-1.png" width="672" /></p>
</div>
<div id="regressão-linear-multipla" class="section level2">
<h2><span class="header-section-number">8.5</span> Regressão Linear Multipla</h2>
<p>Os modelos múltiplos são aqueles em que duas ou mais variáveis independentes influenciam na variação da variável dependente. Eles podem ser de grau 1,2 ou maior. O exemplo a seguir aborda uma regressão polinomial multipla de 2º grau, com duas variáveis independentes.</p>
<p>y= a+ bx + b1x1 + b2x2 + b3x3…</p>
<p>Exemplo:</p>
<div class="sourceCode" id="cb773"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb773-1" title="1"><span class="kw">library</span>(car)</a></code></pre></div>
<pre><code>## Loading required package: carData</code></pre>
<pre><code>## 
## Attaching package: &#39;car&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     some</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     recode</code></pre>
<div class="sourceCode" id="cb778"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb778-1" title="1"><span class="kw">data</span>(iris)</a>
<a class="sourceLine" id="cb778-2" title="2"><span class="kw">head</span>(iris)</a></code></pre></div>
<pre><code>##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 1          5.1         3.5          1.4         0.2  setosa
## 2          4.9         3.0          1.4         0.2  setosa
## 3          4.7         3.2          1.3         0.2  setosa
## 4          4.6         3.1          1.5         0.2  setosa
## 5          5.0         3.6          1.4         0.2  setosa
## 6          5.4         3.9          1.7         0.4  setosa</code></pre>
<p>VIF - variation inflation factor / fator de inflação da variância:</p>
<div class="sourceCode" id="cb780"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb780-1" title="1">fit1&lt;-<span class="kw">lm</span>(Sepal.Length <span class="op">~</span><span class="st"> </span>Sepal.Width <span class="op">+</span><span class="st"> </span>Petal.Length, <span class="dt">data=</span>iris)</a></code></pre></div>
<div class="sourceCode" id="cb781"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb781-1" title="1"><span class="kw">vif</span>(fit1)<span class="co"># ok, valores &lt;5</span></a></code></pre></div>
<pre><code>##  Sepal.Width Petal.Length 
##     1.224831     1.224831</code></pre>
<div class="sourceCode" id="cb783"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb783-1" title="1"><span class="kw">summary</span>(fit1)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Sepal.Length ~ Sepal.Width + Petal.Length, data = iris)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.96159 -0.23489  0.00077  0.21453  0.78557 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   2.24914    0.24797    9.07 7.04e-16 ***
## Sepal.Width   0.59552    0.06933    8.59 1.16e-14 ***
## Petal.Length  0.47192    0.01712   27.57  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.3333 on 147 degrees of freedom
## Multiple R-squared:  0.8402, Adjusted R-squared:  0.838 
## F-statistic: 386.4 on 2 and 147 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb785"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb785-1" title="1">fit2 &lt;-<span class="st"> </span><span class="kw">lm</span> (Sepal.Length <span class="op">~</span><span class="st"> </span>Sepal.Width <span class="op">+</span><span class="st"> </span>Petal.Length <span class="op">+</span><span class="st"> </span>Petal.Width, <span class="dt">data=</span>iris)</a>
<a class="sourceLine" id="cb785-2" title="2"><span class="kw">vif</span>(fit2) <span class="co">#problemático, valores&gt;10</span></a></code></pre></div>
<pre><code>##  Sepal.Width Petal.Length  Petal.Width 
##     1.270815    15.097572    14.234335</code></pre>
<div class="sourceCode" id="cb787"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb787-1" title="1"><span class="kw">summary</span>(fit2)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Sepal.Length ~ Sepal.Width + Petal.Length + Petal.Width, 
##     data = iris)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.82816 -0.21989  0.01875  0.19709  0.84570 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   1.85600    0.25078   7.401 9.85e-12 ***
## Sepal.Width   0.65084    0.06665   9.765  &lt; 2e-16 ***
## Petal.Length  0.70913    0.05672  12.502  &lt; 2e-16 ***
## Petal.Width  -0.55648    0.12755  -4.363 2.41e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.3145 on 146 degrees of freedom
## Multiple R-squared:  0.8586, Adjusted R-squared:  0.8557 
## F-statistic: 295.5 on 3 and 146 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb789"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb789-1" title="1">fit3&lt;-<span class="kw">lm</span>(Sepal.Length <span class="op">~</span><span class="st"> </span>Sepal.Width <span class="op">*</span><span class="st"> </span>Petal.Length, <span class="dt">data=</span>iris)</a>
<a class="sourceLine" id="cb789-2" title="2"><span class="kw">vif</span>(fit3)<span class="co"># muito problemático, valores muito altos</span></a></code></pre></div>
<pre><code>##              Sepal.Width             Petal.Length Sepal.Width:Petal.Length 
##                 6.457248                81.811109                69.223186</code></pre>
<div class="sourceCode" id="cb791"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb791-1" title="1"><span class="kw">summary</span>(fit3)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Sepal.Length ~ Sepal.Width * Petal.Length, data = iris)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.99594 -0.21165 -0.01652  0.21244  0.77249 
## 
## Coefficients:
##                          Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)               1.40438    0.53253   2.637  0.00926 ** 
## Sepal.Width               0.84996    0.15800   5.379 2.91e-07 ***
## Petal.Length              0.71846    0.13886   5.174 7.45e-07 ***
## Sepal.Width:Petal.Length -0.07701    0.04305  -1.789  0.07571 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.3308 on 146 degrees of freedom
## Multiple R-squared:  0.8436, Adjusted R-squared:  0.8404 
## F-statistic: 262.5 on 3 and 146 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Outras funções interessantes:</p>
<div class="sourceCode" id="cb793"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb793-1" title="1"><span class="kw">coefficients</span>(fit1) <span class="co"># coeficientes</span></a></code></pre></div>
<pre><code>##  (Intercept)  Sepal.Width Petal.Length 
##    2.2491402    0.5955247    0.4719200</code></pre>
<div class="sourceCode" id="cb795"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb795-1" title="1"><span class="kw">confint</span>(fit1, <span class="dt">level=</span><span class="fl">0.95</span>) <span class="co"># Intervalos de confiança</span></a></code></pre></div>
<pre><code>##                  2.5 %    97.5 %
## (Intercept)  1.7590943 2.7391860
## Sepal.Width  0.4585161 0.7325334
## Petal.Length 0.4380915 0.5057486</code></pre>
<div class="sourceCode" id="cb797"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb797-1" title="1"><span class="kw">fitted</span>(fit1) <span class="co"># valores previstos</span></a></code></pre></div>
<pre><code>##        1        2        3        4        5        6        7        8 
## 4.994165 4.696402 4.768315 4.803147 5.053717 5.373951 4.934612 4.981804 
##        9       10       11       12       13       14       15       16 
## 4.636850 4.803147 5.160462 5.028996 4.696402 4.554826 5.197543 5.577329 
##       17       18       19       20       21       22       23       24 
## 5.185183 4.994165 5.314398 5.220014 5.076188 5.160462 4.864949 5.016636 
##       25       26       27       28       29       30       31       32 
## 5.170572 4.790786 5.028996 5.041357 4.934612 4.909891 4.850339 4.981804 
##       33       34       35       36       37       38       39       40 
## 5.398672 5.411032 4.803147 4.721123 4.946973 5.053717 4.649210 4.981804 
##       41       42       43       44       45       46       47       48 
## 4.946973 4.232343 4.768315 5.088549 5.408782 4.696402 5.267206 4.815507 
##       49       50       51       52       53       54       55       56 
## 5.160462 4.875060 6.372844 6.278460 6.407675 5.506527 6.087442 6.040250 
##       57       58       59       60       61       62       63       64 
## 6.432396 5.235736 6.146994 5.697545 5.091910 6.017779 5.446975 6.194186 
##       65       66       67       68       69       70       71       72 
## 5.675074 6.171715 6.159355 5.791929 5.682935 5.578440 6.420036 5.804290 
##       73       74       75       76       77       78       79       80 
## 6.050360 6.134634 6.005418 6.112163 6.181826 6.395315 6.099802 5.449225 
##       81       82       83       84       85       86       87       88 
## 5.471696 5.424504 5.697545 6.263849 6.159355 6.397564 6.313291 5.695295 
##       89       90       91       92       93       94       95       96 
## 5.970587 5.625632 5.873953 6.206547 5.685185 5.176183 5.839121 6.017779 
##       97       98       99      100      101      102      103      104 
## 5.958226 6.005418 5.153712 5.851482 7.045892 6.263849 6.820043 6.618914 
##      105      106      107      108      109      110      111      112 
## 6.772851 7.150387 5.861592 6.949258 6.475088 7.271741 6.561612 6.358233 
##      113      114      115      116      117      118      119      120 
## 6.631275 6.097552 6.323402 6.655996 6.631275 7.673998 7.053753 5.918895 
##      121      122      123      124      125      126      127      128 
## 6.844764 6.229018 7.078474 6.169465 6.904316 6.986340 6.181826 6.348123 
##      129      130      131      132      133      134      135      136 
## 6.559362 6.772851 6.795322 7.532422 6.559362 6.323402 6.440257 6.914427 
##      137      138      139      140      141      142      143      144 
## 6.916677 6.690827 6.300931 6.643635 6.738019 6.502059 6.263849 6.939148 
##      145      146      147      148      149      150 
## 6.904316 6.489699 6.097552 6.489699 6.822293 6.442507</code></pre>
<div class="sourceCode" id="cb799"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb799-1" title="1"><span class="kw">residuals</span>(fit1) <span class="co"># residuais</span></a></code></pre></div>
<pre><code>##            1            2            3            4            5            6 
##  0.105835164  0.203597538 -0.068315407 -0.203146940 -0.053717311  0.026049253 
##            7            8            9           10           11           12 
## -0.334612361  0.018195635 -0.236849987  0.096853060  0.239538210 -0.228996369 
##           13           14           15           16           17           18 
##  0.103597538 -0.254826450  0.602456797  0.122670886  0.214817268  0.105835164 
##           19           20           21           22           23           24 
##  0.385601728 -0.120014265  0.323811627 -0.060461790 -0.264949295  0.083364102 
##           25           26           27           28           29           30 
## -0.370572381  0.209213530 -0.028996369  0.158643160  0.265387639 -0.209891419 
##           31           32           33           34           35           36 
## -0.050338944  0.418195635 -0.198671689  0.088967840  0.096853060  0.278876596 
##           37           38           39           40           41           42 
##  0.553027168 -0.153717311 -0.249210458  0.118195635  0.053027168  0.267656866 
##           43           44           45           46           47           48 
## -0.368315407 -0.088548844 -0.308782280  0.103597538 -0.167206269 -0.215507411 
##           49           50           51           52           53           54 
##  0.139538210  0.124940114  0.627156459  0.121540467  0.492324926 -0.006527240 
##           55           56           57           58           59           60 
##  0.412558362 -0.340249634 -0.132396016 -0.335735687  0.453005887 -0.497545135 
##           61           62           63           64           65           66 
## -0.091909796 -0.117778572  0.553025235 -0.094186117 -0.075074073  0.528284945 
##           67           68           69           70           71           72 
## -0.559354584  0.008070857  0.517065215  0.021559814 -0.520035545  0.295710386 
##           73           74           75           76           77           78 
##  0.249639775 -0.034633642  0.394581899  0.487837420  0.618174354  0.304685397 
##           79           80           81           82           83           84 
## -0.099802109  0.250775355  0.028304293  0.075496297  0.102454865 -0.263849183 
##           85           86           87           88           89           90 
## -0.759354584 -0.397564483  0.386708934  0.604704744 -0.370586568 -0.125632190 
##           91           92           93           94           95           96 
## -0.373952680 -0.106546588  0.114815336 -0.176183212 -0.239121147 -0.317778572 
##           97           98           99          100          101          102 
## -0.258226097  0.194581899 -0.053712150 -0.151481618 -0.745892067 -0.463849183 
##          103          104          105          106          107          108 
##  0.279957361 -0.318914152 -0.272850635  0.449613334 -0.961592209  0.350741820 
##          109          110          111          112          113          114 
##  0.224911740 -0.071741496 -0.061611557  0.041766810  0.168725377 -0.397552229 
##          115          116          117          118          119          120 
## -0.523401657 -0.255995565 -0.131274623  0.026001531  0.646247222  0.081105196 
##          121          122          123          124          125          126 
##  0.055236419 -0.629017650  0.621526280  0.130534825 -0.204316055  0.213660408 
##          127          128          129          130          131          132 
##  0.018174354 -0.248122599 -0.159361677  0.427149365  0.604678303  0.367577543 
##          133          134          135          136          137          138 
## -0.159361677 -0.023401657 -0.340256727  0.785573353 -0.616676526 -0.290827098 
##          139          140          141          142          143          144 
## -0.300930595  0.256364906 -0.038019102  0.397940918 -0.463849183 -0.139147588 
##          145          146          147          148          149          150 
## -0.204316055  0.210301389  0.202447771  0.010301389 -0.622292518 -0.542506607</code></pre>
<div class="sourceCode" id="cb801"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb801-1" title="1"><span class="kw">anova</span>(fit1) <span class="co"># tabela anova</span></a></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: Sepal.Length
##               Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## Sepal.Width    1  1.412   1.412  12.714 0.0004902 ***
## Petal.Length   1 84.427  84.427 760.059 &lt; 2.2e-16 ***
## Residuals    147 16.329   0.111                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb803"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb803-1" title="1"><span class="kw">vcov</span>(fit1) <span class="co"># matriz de covariancia </span></a></code></pre></div>
<pre><code>##               (Intercept)   Sepal.Width  Petal.Length
## (Intercept)   0.061488936 -0.0166054883 -0.0026556385
## Sepal.Width  -0.016605488  0.0048063941  0.0005084458
## Petal.Length -0.002655638  0.0005084458  0.0002930149</code></pre>
<div id="referência-6" class="section level3">
<h3><span class="header-section-number">8.5.1</span> Referência</h3>
<p>MELO, M. P.; PETERNELI, L. A. Conhecendo o R: Um visão mais que estatística. Viçosa, MG: UFV, 2013. 222p. Cap. 1.</p>
<p>ZEVIANI, W. M. Estatástica Básica e Experimentação no R. 45p.</p>
<p><a href="http://www.leg.ufpr.br/~paulojus/" class="uri">http://www.leg.ufpr.br/~paulojus/</a></p>
<p><a href="https://docs.r4photobiology.info/ggpmisc/articles/user-guide-1.html" class="uri">https://docs.r4photobiology.info/ggpmisc/articles/user-guide-1.html</a></p>

</div>
</div>
<div id="regressão-não-linear" class="section level2">
<h2><span class="header-section-number">8.6</span> Regressão não linear</h2>
<p>Para o ajuste de regressões não-lineares com o R aconselhamos o uso da função <code>nls()</code> (modelo,dados,valores iniciais estimados dos parâmetros)</p>
<p>Exemplo:</p>
<p>Num projeto de construção de uma barragem é de grande interesse equacionar a relação entre a cota do nível d’água e o volume armazenado quando esta cota é atingida. Essa relação é obtida a partir de um diagrama cota-volume estimado através do levantamento topográfico da região onde será construída a barragem e suas respectivas curvas de nível. Suponha os dados a seguir, com a cota dada em metros e o volume em quilômetros cúbicos:</p>
<div class="sourceCode" id="cb805"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb805-1" title="1">cota&lt;-<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>) </a>
<a class="sourceLine" id="cb805-2" title="2">volume&lt;-<span class="kw">c</span>(<span class="dv">7</span>,<span class="dv">10</span>,<span class="dv">14</span>,<span class="dv">20</span>,<span class="dv">31</span>,<span class="dv">40</span>,<span class="dv">58</span>,<span class="dv">84</span>,<span class="dv">113</span>,<span class="dv">165</span>) </a>
<a class="sourceLine" id="cb805-3" title="3">dados&lt;-<span class="kw">data.frame</span>(cota,volume) </a>
<a class="sourceLine" id="cb805-4" title="4"><span class="kw">plot</span>(dados)</a></code></pre></div>
<p><img src="TudodoR_files/figure-html/unnamed-chunk-431-1.png" width="672" /></p>
<div class="sourceCode" id="cb806"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb806-1" title="1">funcao &lt;-<span class="st"> </span>volume<span class="op">~</span>a<span class="op">*</span><span class="kw">exp</span>(b<span class="op">*</span>cota) </a>
<a class="sourceLine" id="cb806-2" title="2">exponencial &lt;-<span class="st"> </span><span class="kw">nls</span>(funcao, <span class="co">#modelo que se deseja ajustar($) </span></a>
<a class="sourceLine" id="cb806-3" title="3">    dados, <span class="co">#data.frame com o conjunto de dados</span></a>
<a class="sourceLine" id="cb806-4" title="4">    <span class="dt">start=</span><span class="kw">c</span>(<span class="dt">a=</span><span class="dv">1</span>,<span class="dt">b=</span><span class="dv">1</span>)) <span class="co">#valores iniciais dos parâmetros($$)   </span></a>
<a class="sourceLine" id="cb806-5" title="5">    <span class="kw">summary</span>(exponencial)</a></code></pre></div>
<pre><code>## 
## Formula: volume ~ a * exp(b * cota)
## 
## Parameters:
##   Estimate Std. Error t value Pr(&gt;|t|)    
## a 5.116389   0.227553   22.48 1.62e-08 ***
## b 0.346720   0.004879   71.06 1.71e-12 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.559 on 8 degrees of freedom
## 
## Number of iterations to convergence: 14 
## Achieved convergence tolerance: 2.694e-07</code></pre>
<p>Desenhando a curva ajustada</p>
<div class="sourceCode" id="cb808"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb808-1" title="1"><span class="kw">plot</span>(dados) </a>
<a class="sourceLine" id="cb808-2" title="2"><span class="kw">curve</span>(<span class="fl">5.1163887</span><span class="op">*</span><span class="kw">exp</span>(<span class="fl">0.34672</span><span class="op">*</span>x), <span class="dv">1</span>, <span class="co">#limite inferior eixo das abscissas</span></a>
<a class="sourceLine" id="cb808-3" title="3">      <span class="dv">10</span>, <span class="co">#limite superior</span></a>
<a class="sourceLine" id="cb808-4" title="4">      <span class="dt">add=</span>T, <span class="co">#acrescentar no gráfico anterior </span></a>
<a class="sourceLine" id="cb808-5" title="5">      <span class="dt">col=</span><span class="dv">2</span>) <span class="co">#cor da curva (2 = vermelha)</span></a></code></pre></div>
<p><img src="TudodoR_files/figure-html/unnamed-chunk-433-1.png" width="672" /></p>
<div id="curva-de-retenção-de-água-no-solo" class="section level3">
<h3><span class="header-section-number">8.6.1</span> Curva de retenção de água no solo</h3>
<p>O objetivo é determinar da curva de retenção de água no solo estimada segundo modelo de van Genutchen para cada uma das amostras.</p>
<p>Fonte: <a href="http://www.leg.ufpr.br/~paulojus/embrapa/" class="uri">http://www.leg.ufpr.br/~paulojus/embrapa/</a></p>
<div class="sourceCode" id="cb809"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb809-1" title="1">cra &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;http://www.leg.ufpr.br/~paulojus/dados/cra.csv&quot;</span>, <span class="dt">head =</span> T, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>) </a>
<a class="sourceLine" id="cb809-2" title="2"><span class="kw">head</span>(cra)</a></code></pre></div>
<pre><code>##   am pot      u
## 1 30  10 0.3071
## 2 30  19 0.2931
## 3 30  30 0.2828
## 4 30  45 0.2753
## 5 30  63 0.2681
## 6 30  64 0.2628</code></pre>
<div class="sourceCode" id="cb811"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb811-1" title="1">cra &lt;-<span class="st"> </span><span class="kw">transform</span>(cra, <span class="dt">am =</span> <span class="kw">as.factor</span>(am)) </a>
<a class="sourceLine" id="cb811-2" title="2"><span class="kw">summary</span>(cra)</a></code></pre></div>
<pre><code>##   am          pot                u         
##  30:15   Min.   :   10.0   Min.   :0.0636  
##  41:13   1st Qu.:   58.5   1st Qu.:0.1199  
##          Median :  107.5   Median :0.1969  
##          Mean   : 2139.8   Mean   :0.1879  
##          3rd Qu.: 1550.0   3rd Qu.:0.2436  
##          Max.   :26300.0   Max.   :0.3071</code></pre>
<p>Isolar a amostra 30</p>
<div class="sourceCode" id="cb813"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb813-1" title="1">cra30 &lt;-<span class="st"> </span><span class="kw">subset</span>(cra, am <span class="op">==</span><span class="st"> &quot;41&quot;</span>)</a>
<a class="sourceLine" id="cb813-2" title="2">cra30</a></code></pre></div>
<pre><code>##    am   pot      u
## 16 41    11 0.2407
## 17 41    14 0.2209
## 18 41    34 0.2100
## 19 41    65 0.2004
## 20 41    94 0.1935
## 21 41   110 0.1842
## 22 41   157 0.1706
## 23 41  1700 0.1023
## 24 41  1200 0.1180
## 25 41  1100 0.1261
## 26 41  1500 0.1101
## 27 41  2300 0.0917
## 28 41 12100 0.0636</code></pre>
<p>Figura com no eixo horizontal com logarítmo (base 10), dados de umidade versus pressão aplicada na amostra.</p>
<div class="sourceCode" id="cb815"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb815-1" title="1"><span class="kw">with</span>(cra30, <span class="kw">plot</span>(u <span class="op">~</span><span class="st"> </span><span class="kw">log10</span>(pot), <span class="dt">xlab =</span> <span class="kw">expression</span>(log[<span class="dv">10</span>](Psi[m])), <span class="dt">ylab =</span> <span class="kw">expression</span>(theta), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.7</span>)))</a></code></pre></div>
<p><img src="TudodoR_files/figure-html/unnamed-chunk-437-1.png" width="672" /></p>
<p>Figura dos dados de umidade versus pressão aplicada na amostra</p>
<div class="sourceCode" id="cb816"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb816-1" title="1"><span class="kw">with</span>(cra30, <span class="kw">plot</span>(u <span class="op">~</span><span class="st"> </span>pot, <span class="dt">xlab =</span> <span class="kw">expression</span>(Psi[m]), </a>
<a class="sourceLine" id="cb816-2" title="2">                 <span class="dt">ylab =</span> <span class="kw">expression</span>(theta),</a>
<a class="sourceLine" id="cb816-3" title="3">                 <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.7</span>))) </a>
<a class="sourceLine" id="cb816-4" title="4">        <span class="kw">curve</span>(<span class="fl">0.05</span> <span class="op">+</span><span class="st"> </span>(<span class="fl">0.35</span> <span class="op">-</span><span class="st"> </span><span class="fl">0.05</span>)<span class="op">/</span>((<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(<span class="fl">0.1</span> <span class="op">*</span><span class="st"> </span>x)<span class="op">^</span><span class="fl">1.3</span>)<span class="op">^</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span><span class="fl">1.3</span>)), <span class="dt">from =</span> <span class="dv">0</span>, </a>
<a class="sourceLine" id="cb816-5" title="5">  <span class="dt">to =</span> <span class="dv">27000</span>, <span class="dt">add =</span> T, <span class="dt">lty =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="TudodoR_files/figure-html/unnamed-chunk-438-1.png" width="672" /></p>
<p>Definidos os valores iniciais prossegue-se com o ajuste do modelo conforme os comandos a seguir</p>
<div class="sourceCode" id="cb817"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb817-1" title="1">fit30 =<span class="st"> </span><span class="kw">nls</span>(u <span class="op">~</span><span class="st"> </span>ur <span class="op">+</span><span class="st"> </span>(us <span class="op">-</span><span class="st"> </span>ur)<span class="op">/</span>((<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(alpha <span class="op">*</span><span class="st"> </span>pot)<span class="op">^</span>n)<span class="op">^</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>n)), <span class="dt">data =</span> cra30, <span class="dt">start =</span> <span class="kw">list</span>(<span class="dt">us =</span> <span class="fl">0.35</span>, <span class="dt">ur =</span> <span class="fl">0.05</span>, <span class="dt">alpha =</span> <span class="fl">0.1</span>, <span class="dt">n =</span> <span class="fl">1.3</span>))</a>
<a class="sourceLine" id="cb817-2" title="2"></a>
<a class="sourceLine" id="cb817-3" title="3"><span class="kw">summary</span>(fit30)</a></code></pre></div>
<pre><code>## 
## Formula: u ~ ur + (us - ur)/((1 + (alpha * pot)^n)^(1 - 1/n))
## 
## Parameters:
##        Estimate Std. Error t value Pr(&gt;|t|)    
## us     0.243148   0.009446  25.741 9.71e-10 ***
## ur    -0.122402   0.171614  -0.713    0.494    
## alpha  0.035928   0.022324   1.609    0.142    
## n      1.113320   0.079473  14.009 2.04e-07 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.006207 on 9 degrees of freedom
## 
## Number of iterations to convergence: 9 
## Achieved convergence tolerance: 9.545e-06</code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="testes-estatísticos.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="multivariada.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["TudodoR.pdf", "TudodoR.epub", "TudodoR.mobi"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
